window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console)console.log(Array.prototype.slice.call(arguments))};(function(){if(!window.gettext){window.gettext=function(e){return e}}gettext("Settings error")})();(function(e){var t=e.write;e.write=function(n){if(/docwriteregexwhitelist/.test(n)){t.apply(e,arguments)}}})(document);(function(e){function t(){var t=e(this);e(t.data(r)).css("display","none")}function n(){var t=this;setTimeout(function(){var n=e(t);e(n.data(r)).css("top",n.position().top+"px").css("left",n.position().left+"px").css("display",n.val()?"none":"block")},200)}var r="PLACEHOLDER-LABEL",i=false,s={labelClass:"placeholder"},o=document.createElement("input");if("placeholder"in o){e.fn.placeholder=e.fn.unplaceholder=function(){};delete o}else{delete o;e.fn.placeholder=function(o){if(!i){e(".PLACEHOLDER-INPUT").live("click",t).live("focusin",t).live("focusout",n);i=bound=true}var u=e.extend(s,o);this.each(function(){var i=Math.random().toString(32).replace(/\./,""),s=e(this),o=e('<label style="position:absolute;display:none;top:0;left:0;"></label>');if(!(!s.attr("placeholder")||s.data("PLACEHOLDER-INPUT")==="PLACEHOLDER-INPUT")){s.attr("id")||(s.attr("id")="input_"+i);o.attr("id",s.attr("id")+"_placeholder").data("PLACEHOLDER-INPUT","#"+s.attr("id")).attr("for",s.attr("id")).addClass(u.labelClass).addClass(u.labelClass+"-for-"+this.tagName.toLowerCase()).addClass(r).text(s.attr("placeholder"));s.data(r,"#"+o.attr("id")).data("PLACEHOLDER-INPUT","PLACEHOLDER-INPUT").addClass("PLACEHOLDER-INPUT").after(o);t.call(this);n.call(this)}})};e.fn.unplaceholder=function(){this.each(function(){var t=e(this),n=e(t.data(r));if(t.data("PLACEHOLDER-INPUT")==="PLACEHOLDER-INPUT"){n.remove();t.removeData("PLACEHOLDER-INPUT").removeData(r).removeClass("PLACEHOLDER-INPUT")}})}}})(jQuery);(function(e){"use strict";function t(t){var n=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(t.target).ajaxSubmit(n))}function n(t){var n=t.target,r=e(n);if(!r.is("[type=submit],[type=image]")){var i=r.closest("[type=submit]");if(0===i.length)return;n=i[0]}var s=this;if(s.clk=n,"image"==n.type)if(void 0!==t.offsetX)s.clk_x=t.offsetX,s.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var o=r.offset();s.clk_x=t.pageX-o.left,s.clk_y=t.pageY-o.top}else s.clk_x=t.pageX-n.offsetLeft,s.clk_y=t.pageY-n.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)}function r(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}var i={};i.fileapi=void 0!==e("<input type='file'/>").get(0).files,i.formdata=void 0!==window.FormData;var s=!!e.fn.prop;e.fn.attr2=function(){if(!s)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||"string"==typeof e?e:this.attr.apply(this,arguments)},e.fn.ajaxSubmit=function(t){function n(n){var r,i,s=e.param(n,t.traditional).split("&"),o=s.length,u=[];for(r=0;o>r;r++)s[r]=s[r].replace(/\+/g," "),i=s[r].split("="),u.push([decodeURIComponent(i[0]),decodeURIComponent(i[1])]);return u}function o(r){for(var i=new FormData,s=0;r.length>s;s++)i.append(r[s].name,r[s].value);if(t.extraData){var o=n(t.extraData);for(s=0;o.length>s;s++)o[s]&&i.append(o[s][0],o[s][1])}t.data=null;var u=e.extend(!0,{},e.ajaxSettings,t,{contentType:!1,processData:!1,cache:!1,type:f||"POST"});t.uploadProgress&&(u.xhr=function(){var n=e.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(e){var n=0,r=e.loaded||e.position,i=e.total;e.lengthComputable&&(n=Math.ceil(100*(r/i))),t.uploadProgress(e,r,i,n)},!1),n}),u.data=null;var a=u.beforeSend;return u.beforeSend=function(e,n){n.data=t.formData?t.formData:i,a&&a.call(this,e,n)},e.ajax(u)}function u(n){function i(e){var t=null;try{e.contentWindow&&(t=e.contentWindow.document)}catch(n){r("cannot get iframe.contentWindow document: "+n)}if(t)return t;try{t=e.contentDocument?e.contentDocument:e.document}catch(n){r("cannot get iframe.contentDocument: "+n),t=e.document}return t}function o(){function t(){try{var e=i(y).readyState;r("state = "+e),e&&"uninitialized"==e.toLowerCase()&&setTimeout(t,50)}catch(n){r("Server abort: ",n," (",n.name,")"),u(k),x&&clearTimeout(x),x=void 0}}var n=h.attr2("target"),s=h.attr2("action");T.setAttribute("target",v),(!f||/post/i.test(f))&&T.setAttribute("method","POST"),s!=p.url&&T.setAttribute("action",p.url),p.skipEncodingOverride||f&&!/post/i.test(f)||h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),p.timeout&&(x=setTimeout(function(){S=!0,u(C)},p.timeout));var o=[];try{if(p.extraData)for(var l in p.extraData)p.extraData.hasOwnProperty(l)&&(e.isPlainObject(p.extraData[l])&&p.extraData[l].hasOwnProperty("name")&&p.extraData[l].hasOwnProperty("value")?o.push(e('<input type="hidden" name="'+p.extraData[l].name+'">').val(p.extraData[l].value).appendTo(T)[0]):o.push(e('<input type="hidden" name="'+l+'">').val(p.extraData[l]).appendTo(T)[0]));p.iframeTarget||g.appendTo("body"),y.attachEvent?y.attachEvent("onload",u):y.addEventListener("load",u,!1),setTimeout(t,15);try{T.submit()}catch(c){var d=document.createElement("form").submit;d.apply(T)}}finally{T.setAttribute("action",s),n?T.setAttribute("target",n):h.removeAttr("target"),e(o).remove()}}function u(t){if(!b.aborted&&!_){if(M=i(y),M||(r("cannot access response document"),t=k),t===C&&b)return b.abort("timeout"),N.reject(b,"timeout"),void 0;if(t==k&&b)return b.abort("server abort"),N.reject(b,"error","server abort"),void 0;if(M&&M.location.href!=p.iframeSrc||S){y.detachEvent?y.detachEvent("onload",u):y.removeEventListener("load",u,!1);var n,s="success";try{if(S)throw"timeout";var o="xml"==p.dataType||M.XMLDocument||e.isXMLDoc(M);if(r("isXml="+o),!o&&window.opera&&(null===M.body||!M.body.innerHTML)&&--D)return r("requeing onLoad callback, DOM not available"),setTimeout(u,250),void 0;var f=M.body?M.body:M.documentElement;b.responseText=f?f.innerHTML:null,b.responseXML=M.XMLDocument?M.XMLDocument:M,o&&(p.dataType="xml"),b.getResponseHeader=function(e){var t={"content-type":p.dataType};return t[e.toLowerCase()]},f&&(b.status=Number(f.getAttribute("status"))||b.status,b.statusText=f.getAttribute("statusText")||b.statusText);var l=(p.dataType||"").toLowerCase(),c=/(json|script|text)/.test(l);if(c||p.textarea){var h=M.getElementsByTagName("textarea")[0];if(h)b.responseText=h.value,b.status=Number(h.getAttribute("status"))||b.status,b.statusText=h.getAttribute("statusText")||b.statusText;else if(c){var v=M.getElementsByTagName("pre")[0],m=M.getElementsByTagName("body")[0];v?b.responseText=v.textContent?v.textContent:v.innerText:m&&(b.responseText=m.textContent?m.textContent:m.innerText)}}else"xml"==l&&!b.responseXML&&b.responseText&&(b.responseXML=P(b.responseText));try{O=B(b,l,p)}catch(w){s="parsererror",b.error=n=w||s}}catch(w){r("error caught: ",w),s="error",b.error=n=w||s}b.aborted&&(r("upload aborted"),s=null),b.status&&(s=b.status>=200&&300>b.status||304===b.status?"success":"error"),"success"===s?(p.success&&p.success.call(p.context,O,"success",b),N.resolve(b.responseText,"success",b),d&&e.event.trigger("ajaxSuccess",[b,p])):s&&(void 0===n&&(n=b.statusText),p.error&&p.error.call(p.context,b,s,n),N.reject(b,"error",n),d&&e.event.trigger("ajaxError",[b,p,n])),d&&e.event.trigger("ajaxComplete",[b,p]),d&&!--e.active&&e.event.trigger("ajaxStop"),p.complete&&p.complete.call(p.context,b,s),_=!0,p.timeout&&clearTimeout(x),setTimeout(function(){p.iframeTarget?g.attr("src",p.iframeSrc):g.remove(),b.responseXML=null},100)}}}var l,c,p,d,v,g,y,b,w,E,S,x,T=h[0],N=e.Deferred();if(N.abort=function(e){b.abort(e)},n)for(c=0;m.length>c;c++)l=e(m[c]),s?l.prop("disabled",!1):l.removeAttr("disabled");if(p=e.extend(!0,{},e.ajaxSettings,t),p.context=p.context||p,v="jqFormIO"+(new Date).getTime(),p.iframeTarget?(g=e(p.iframeTarget),E=g.attr2("name"),E?v=E:g.attr2("name",v)):(g=e('<iframe name="'+v+'" src="'+p.iframeSrc+'" />'),g.css({position:"absolute",top:"-1000px",left:"-1000px"})),y=g[0],b={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n="timeout"===t?"timeout":"aborted";r("aborting upload... "+n),this.aborted=1;try{y.contentWindow.document.execCommand&&y.contentWindow.document.execCommand("Stop")}catch(i){}g.attr("src",p.iframeSrc),b.error=n,p.error&&p.error.call(p.context,b,n,t),d&&e.event.trigger("ajaxError",[b,p,n]),p.complete&&p.complete.call(p.context,b,n)}},d=p.global,d&&0===e.active++&&e.event.trigger("ajaxStart"),d&&e.event.trigger("ajaxSend",[b,p]),p.beforeSend&&p.beforeSend.call(p.context,b,p)===!1)return p.global&&e.active--,N.reject(),N;if(b.aborted)return N.reject(),N;w=T.clk,w&&(E=w.name,E&&!w.disabled&&(p.extraData=p.extraData||{},p.extraData[E]=w.value,"image"==w.type&&(p.extraData[E+".x"]=T.clk_x,p.extraData[E+".y"]=T.clk_y)));var C=1,k=2,L=e("meta[name=csrf-token]").attr("content"),A=e("meta[name=csrf-param]").attr("content");A&&L&&(p.extraData=p.extraData||{},p.extraData[A]=L),p.forceSync?o():setTimeout(o,10);var O,M,_,D=50,P=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},H=e.parseJSON||function(e){return window.eval("("+e+")")},B=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s="xml"===n||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;return s&&"parsererror"===o.documentElement.nodeName&&e.error&&e.error("parsererror"),r&&r.dataFilter&&(o=r.dataFilter(o,n)),"string"==typeof o&&("json"===n||!n&&i.indexOf("json")>=0?o=H(o):("script"===n||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o)),o};return N}if(!this.length)return r("ajaxSubmit: skipping submit process - no element selected"),this;var f,l,c,h=this;"function"==typeof t?t={success:t}:void 0===t&&(t={}),f=t.type||this.attr2("method"),l=t.url||this.attr2("action"),c="string"==typeof l?e.trim(l):"",c=c||window.location.href||"",c&&(c=(c.match(/^([^#]+)/)||[])[1]),t=e.extend(!0,{url:c,success:e.ajaxSettings.success,type:f||e.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},t);var p={};if(this.trigger("form-pre-serialize",[this,t,p]),p.veto)return r("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(t.beforeSerialize&&t.beforeSerialize(this,t)===!1)return r("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var d=t.traditional;void 0===d&&(d=e.ajaxSettings.traditional);var v,m=[],g=this.formToArray(t.semantic,m);if(t.data&&(t.extraData=t.data,v=e.param(t.data,d)),t.beforeSubmit&&t.beforeSubmit(g,this,t)===!1)return r("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[g,this,t,p]),p.veto)return r("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var y=e.param(g,d);v&&(y=y?y+"&"+v:v),"GET"==t.type.toUpperCase()?(t.url+=(t.url.indexOf("?")>=0?"&":"?")+y,t.data=null):t.data=y;var b=[];if(t.resetForm&&b.push(function(){h.resetForm()}),t.clearForm&&b.push(function(){h.clearForm(t.includeHidden)}),!t.dataType&&t.target){var w=t.success||function(){};b.push(function(n){var r=t.replaceTarget?"replaceWith":"html";e(t.target)[r](n).each(w,arguments)})}else t.success&&b.push(t.success);if(t.success=function(e,n,r){for(var i=t.context||this,s=0,o=b.length;o>s;s++)b[s].apply(i,[e,n,r||h,h])},t.error){var E=t.error;t.error=function(e,n,r){var i=t.context||this;E.apply(i,[e,n,r,h])}}if(t.complete){var S=t.complete;t.complete=function(e,n){var r=t.context||this;S.apply(r,[e,n,h])}}var x=e("input[type=file]:enabled",this).filter(function(){return""!==e(this).val()}),T=x.length>0,N="multipart/form-data",C=h.attr("enctype")==N||h.attr("encoding")==N,k=i.fileapi&&i.formdata;r("fileAPI :"+k);var L,A=(T||C)&&!k;t.iframe!==!1&&(t.iframe||A)?t.closeKeepAlive?e.get(t.closeKeepAlive,function(){L=u(g)}):L=u(g):L=(T||C)&&k?o(g):e.ajax(t),h.removeData("jqxhr").data("jqxhr",L);for(var O=0;m.length>O;O++)m[O]=null;return this.trigger("form-submit-notify",[this,t]),this},e.fn.ajaxForm=function(i){if(i=i||{},i.delegation=i.delegation&&e.isFunction(e.fn.on),!i.delegation&&0===this.length){var s={s:this.selector,c:this.context};return!e.isReady&&s.s?(r("DOM not ready, queuing ajaxForm"),e(function(){e(s.s,s.c).ajaxForm(i)}),this):(r("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return i.delegation?(e(document).off("submit.form-plugin",this.selector,t).off("click.form-plugin",this.selector,n).on("submit.form-plugin",this.selector,i,t).on("click.form-plugin",this.selector,i,n),this):this.ajaxFormUnbind().bind("submit.form-plugin",i,t).bind("click.form-plugin",i,n)},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t,n){var r=[];if(0===this.length)return r;var s=this[0],o=t?s.getElementsByTagName("*"):s.elements;if(!o)return r;var u,a,f,l,c,h,p;for(u=0,h=o.length;h>u;u++)if(c=o[u],f=c.name,f&&!c.disabled)if(t&&s.clk&&"image"==c.type)s.clk==c&&(r.push({name:f,value:e(c).val(),type:c.type}),r.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}));else if(l=e.fieldValue(c,!0),l&&l.constructor==Array)for(n&&n.push(c),a=0,p=l.length;p>a;a++)r.push({name:f,value:l[a]});else if(i.fileapi&&"file"==c.type){n&&n.push(c);var d=c.files;if(d.length)for(a=0;d.length>a;a++)r.push({name:f,value:d[a],type:c.type});else r.push({name:f,value:"",type:c.type})}else null!==l&&l!==void 0&&(n&&n.push(c),r.push({name:f,value:l,type:c.type,required:c.required}));if(!t&&s.clk){var v=e(s.clk),m=v[0];f=m.name,f&&!m.disabled&&"image"==m.type&&(r.push({name:f,value:v.val()}),r.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}))}return r},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(r){var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;o>s;s++)n.push({name:r,value:i[s]});else null!==i&&i!==void 0&&n.push({name:this.name,value:i})}}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;i>r;r++){var s=this[r],o=e.fieldValue(s,t);null===o||void 0===o||o.constructor==Array&&!o.length||(o.constructor==Array?e.merge(n,o):n.push(o))}return n},e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();if(void 0===n&&(n=!0),n&&(!r||t.disabled||"reset"==i||"button"==i||("checkbox"==i||"radio"==i)&&!t.checked||("submit"==i||"image"==i)&&t.form&&t.form.clk!=t||"select"==s&&-1==t.selectedIndex))return null;if("select"==s){var o=t.selectedIndex;if(0>o)return null;for(var u=[],a=t.options,f="select-one"==i,l=f?o+1:a.length,c=f?o:0;l>c;c++){var h=a[c];if(h.selected){var p=h.value;if(p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value),f)return p;u.push(p)}}return u}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,i=this.tagName.toLowerCase();n.test(r)||"textarea"==i?this.value="":"checkbox"==r||"radio"==r?this.checked=!1:"select"==i?this.selectedIndex=-1:"file"==r?/MSIE/.test(navigator.userAgent)?e(this).replaceWith(e(this).clone(!0)):e(this).val(""):t&&(t===!0&&/hidden/.test(r)||"string"==typeof t&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var n=this.type;if("checkbox"==n||"radio"==n)this.checked=t;else if("option"==this.tagName.toLowerCase()){var r=e(this).parent("select");t&&r[0]&&"select-one"==r[0].type&&r.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1})("undefined"!=typeof jQuery?jQuery:window.Zepto);(function(e){e.fn.emoticonize=function(t){var n=e.extend({},e.fn.emoticonize.defaults,t);var r=[")","(","*","[","]","{","}","|","^","<",">","\\","?","+","=","."];var i=[":-)",":o)",":c)",":^)",":-D",":-(",":-9",";-)",":-P",":-p",":-Þ",":-b",":-O",":-/",":-X",":-#",":'(","B-)","8-)",";*(",":-*",":-\\","?-)",": )",": ]","= ]","= )","8 )",": }",": D","8 D","X D","x D","= D",": (",": [",": {","= (","; )","; ]","; D",": P",": p","= P","= p",": b",": Þ",": O","8 O",": /","= /",": S",": #",": X","B )",": |",": \\","= \\",": *",": &gt;",": &lt;"];var s=[":)",":]","=]","=)","8)",":}",":D",":(",":[",":{","=(",";)",";]",";D",":P",":p","=P","=p",":b",":Þ",":O",":/","=/",":S",":#",":X","B)",":|",":\\","=\\",":*",":&gt;",":&lt;"];var o={"&gt;:)":{cssClass:"red-emoticon small-emoticon spaced-emoticon"},"&gt;;)":{cssClass:"red-emoticon small-emoticon spaced-emoticon"},"&gt;:(":{cssClass:"red-emoticon small-emoticon spaced-emoticon"},"&gt;: )":{cssClass:"red-emoticon small-emoticon"},"&gt;; )":{cssClass:"red-emoticon small-emoticon"},"&gt;: (":{cssClass:"red-emoticon small-emoticon"},";(":{cssClass:"red-emoticon spaced-emoticon"},"&lt;3":{cssClass:"pink-emoticon counter-rotated"},O_O:{cssClass:"no-rotate"},o_o:{cssClass:"no-rotate"},"0_o":{cssClass:"no-rotate"},O_o:{cssClass:"no-rotate"},T_T:{cssClass:"no-rotate"},"^_^":{cssClass:"no-rotate"},"O:)":{cssClass:"small-emoticon spaced-emoticon"},"O: )":{cssClass:"small-emoticon"},"8D":{cssClass:"small-emoticon spaced-emoticon"},XD:{cssClass:"small-emoticon spaced-emoticon"},xD:{cssClass:"small-emoticon spaced-emoticon"},"=D":{cssClass:"small-emoticon spaced-emoticon"},"8O":{cssClass:"small-emoticon spaced-emoticon"},"[+=..]":{cssClass:"no-rotate nintendo-controller"}};var u=new RegExp("(\\"+r.join("|\\")+")","g");var f="(^|[\\s\\0])";for(var l=i.length-1;l>=0;--l){i[l]=i[l].replace(u,"\\$1");i[l]=new RegExp(f+"("+i[l]+")","g")}for(var l=s.length-1;l>=0;--l){s[l]=s[l].replace(u,"\\$1");s[l]=new RegExp(f+"("+s[l]+")","g")}for(var c in o){o[c].regexp=c.replace(u,"\\$1");o[c].regexp=new RegExp(f+"("+o[c].regexp+")","g")}var h="span.css-emoticon";if(n.exclude){h+=","+n.exclude}var p=h.split(",");return this.not(h).each(function(){var t=e(this);var r="css-emoticon";if(n.animate){r+=" un-transformed-emoticon animated-emoticon"}for(var u in o){specialCssClass=r+" "+o[u].cssClass;t.html(t.html().replace(o[u].regexp,"$1<span data-tag='$2' class='"+specialCssClass+"'>$2</span>"))}e(i).each(function(){t.html(t.html().replace(this,"$1<span data-tag='$2' class='"+r+"'>$2</span>"))});e(s).each(function(){t.html(t.html().replace(this,"$1<span data-tag='$2' class='"+r+" spaced-emoticon'>$2</span>"))});e.each(p,function(n,r){t.find(e.trim(r)+" span.css-emoticon").each(function(){e(this).replaceWith(e(this).text())})});if(n.animate){setTimeout(function(){e(".un-transformed-emoticon").removeClass("un-transformed-emoticon")},n.delay)}})};e.fn.unemoticonize=function(t){var n=e.extend({},e.fn.emoticonize.defaults,t);return this.each(function(){var t=e(this);t.find("span.css-emoticon").each(function(){var t=e(this);if(n.animate){t.addClass("un-transformed-emoticon");setTimeout(function(){t.replaceWith(t.text())},n.delay)}else{t.replaceWith(t.text())}})})};e.fn.emoticonize.defaults={animate:false,delay:3e3,exclude:"pre,code,.no-emoticons"}})(jQuery);(function(e){var t={init:function(n){var r=e.extend({items:1,itemsOnPage:1,pages:0,displayedPages:5,edges:2,currentPage:1,hrefTextPrefix:"#page-",hrefTextSuffix:"",prevText:"Prev",nextText:"Next",ellipseText:"&hellip;",cssStyle:"light-theme",labelMap:[],selectOnClick:true,onPageClick:function(e,t){},onInit:function(){}},n||{});var i=this;r.pages=r.pages?r.pages:Math.ceil(r.items/r.itemsOnPage)?Math.ceil(r.items/r.itemsOnPage):1;r.currentPage=r.currentPage-1;r.halfDisplayed=r.displayedPages/2;this.each(function(){i.addClass(r.cssStyle+" simple-pagination").data("pagination",r);t._draw.call(i)});r.onInit();return this},selectPage:function(e){t._selectPage.call(this,e-1);return this},prevPage:function(){var e=this.data("pagination");if(e.currentPage>0){t._selectPage.call(this,e.currentPage-1)}return this},nextPage:function(){var e=this.data("pagination");if(e.currentPage<e.pages-1){t._selectPage.call(this,e.currentPage+1)}return this},getPagesCount:function(){return this.data("pagination").pages},getCurrentPage:function(){return this.data("pagination").currentPage+1},destroy:function(){this.empty();return this},drawPage:function(e){var n=this.data("pagination");n.currentPage=e-1;this.data("pagination",n);t._draw.call(this);return this},redraw:function(){t._draw.call(this);return this},disable:function(){var e=this.data("pagination");e.disabled=true;this.data("pagination",e);t._draw.call(this);return this},enable:function(){var e=this.data("pagination");e.disabled=false;this.data("pagination",e);t._draw.call(this);return this},updateItems:function(e){var n=this.data("pagination");n.items=e;n.pages=t._getPages(n);this.data("pagination",n);t._draw.call(this)},updateItemsOnPage:function(e){var n=this.data("pagination");n.itemsOnPage=e;n.pages=t._getPages(n);this.data("pagination",n);t._selectPage.call(this,0);return this},_draw:function(){var n=this.data("pagination"),r=t._getInterval(n),i,s;t.destroy.call(this);s=typeof this.prop==="function"?this.prop("tagName"):this.attr("tagName");var o=s==="UL"?this:e("<ul></ul>").appendTo(this);if(n.prevText){t._appendItem.call(this,n.currentPage-1,{text:n.prevText,classes:"prev"})}if(r.start>0&&n.edges>0){var u=Math.min(n.edges,r.start);for(i=0;i<u;i++){t._appendItem.call(this,i)}if(n.edges<r.start&&r.start-n.edges!=1){o.append('<li class="disabled"><span class="ellipse">'+n.ellipseText+"</span></li>")}else if(r.start-n.edges==1){t._appendItem.call(this,n.edges)}}for(i=r.start;i<r.end;i++){t._appendItem.call(this,i)}if(r.end<n.pages&&n.edges>0){if(n.pages-n.edges>r.end&&n.pages-n.edges-r.end!=1){o.append('<li class="disabled"><span class="ellipse">'+n.ellipseText+"</span></li>")}else if(n.pages-n.edges-r.end==1){t._appendItem.call(this,r.end++)}var a=Math.max(n.pages-n.edges,r.end);for(i=a;i<n.pages;i++){t._appendItem.call(this,i)}}if(n.nextText){t._appendItem.call(this,n.currentPage+1,{text:n.nextText,classes:"next"})}},_getPages:function(e){var t=Math.ceil(e.items/e.itemsOnPage);return t||1},_getInterval:function(e){return{start:Math.ceil(e.currentPage>e.halfDisplayed?Math.max(Math.min(e.currentPage-e.halfDisplayed,e.pages-e.displayedPages),0):0),end:Math.ceil(e.currentPage>e.halfDisplayed?Math.min(e.currentPage+e.halfDisplayed,e.pages):Math.min(e.displayedPages,e.pages))}},_appendItem:function(n,r){var i=this,s,o,u=i.data("pagination"),a=e("<li></li>"),f=i.find("ul");n=n<0?0:n<u.pages?n:u.pages-1;s={text:n+1,classes:""};if(u.labelMap.length&&u.labelMap[n]){s.text=u.labelMap[n]}s=e.extend(s,r||{});if(n==u.currentPage||u.disabled){if(u.disabled){a.addClass("disabled")}else{a.addClass("active")}o=e('<span class="current">'+s.text+"</span>")}else{o=e('<a href="'+u.hrefTextPrefix+(n+1)+u.hrefTextSuffix+'" class="page-link">'+s.text+"</a>");o.click(function(e){return t._selectPage.call(i,n,e)})}if(s.classes){o.addClass(s.classes)}a.append(o);if(f.length){f.append(a)}else{i.append(a)}},_selectPage:function(e,n){var r=this.data("pagination");r.currentPage=e;if(r.selectOnClick){t._draw.call(this)}return r.onPageClick(e+1,n)}};e.fn.pagination=function(n){if(t[n]&&n.charAt(0)!="_"){return t[n].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof n==="object"||!n){return t.init.apply(this,arguments)}else{e.error("Method "+n+" does not exist on jQuery.pagination")}}})(jQuery);(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++){try{e(r).triggerHandler("remove")}catch(s){}}i(t)};e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1];i=f+"-"+t;if(!r){r=n;n=e.Widget}e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)};e[f]=e[f]||{};s=e[f][t];o=e[f][t]=function(e,t){if(!this._createWidget){return new o(e,t)}if(arguments.length){this._createWidget(e,t)}};e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]});u=new n;u.options=e.widget.extend({},u.options);e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;this._super=e;this._superApply=i;s=r.apply(this,arguments);this._super=t;this._superApply=n;return s}}()});o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i});if(s){e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)});delete s._childConstructors}else{n._childConstructors.push(o)}e.widget.bridge(t,o)};e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++){for(u in i[s]){a=i[s][u];if(i[s].hasOwnProperty(u)&&a!==t){if(e.isPlainObject(a)){n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a)}else{n[u]=a}}}}return n};e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o==="string",a=r.call(arguments,1),f=this;o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o;if(u){this.each(function(){var r,i=e.data(this,s);if(!i){return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'")}if(!e.isFunction(i[o])||o.charAt(0)==="_"){return e.error("no such method '"+o+"' for "+n+" widget instance")}r=i[o].apply(i,a);if(r!==i&&r!==t){f=r&&r.jquery?f.pushStack(r.get()):r;return false}})}else{this.each(function(){var t=e.data(this,s);if(t){t.option(o||{})._init()}else{e.data(this,s,new i(o,this))}})}return f}};e.Widget=function(){};e.Widget._childConstructors=[];e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0];this.element=e(r);this.uuid=n++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=e.widget.extend({},this.options,this._getCreateOptions(),t);this.bindings=e();this.hoverable=e();this.focusable=e();if(r!==this){e.data(r,this.widgetFullName,this);this._on(true,this.element,{remove:function(e){if(e.target===r){this.destroy()}}});this.document=e(r.style?r.ownerDocument:r.document||r);this.window=e(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0){return e.widget.extend({},this.options)}if(typeof n==="string"){i={};s=n.split(".");n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++){o[s[u]]=o[s[u]]||{};o=o[s[u]]}n=s.pop();if(r===t){return o[n]===t?null:o[n]}o[n]=r}else{if(r===t){return this.options[n]===t?null:this.options[n]}i[n]=r}}this._setOptions(i);return this},_setOptions:function(e){var t;for(t in e){this._setOption(t,e[t])}return this},_setOption:function(e,t){this.options[e]=t;if(e==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_on:function(t,n,r){var i,s=this;if(typeof t!=="boolean"){r=n;n=t;t=false}if(!r){r=n;n=this.element;i=this.widget()}else{n=i=e(n);this.bindings=this.bindings.add(n)}e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===true||e(this).hasClass("ui-state-disabled"))){return}return(typeof o==="string"?s[o]:o).apply(s,arguments)}if(typeof o!=="string"){u.guid=o.guid=o.guid||u.guid||e.guid++}var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];if(l){i.delegate(l,f,u)}else{n.bind(f,u)}})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e==="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{};n=e.Event(n);n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase();n.target=this.element[0];s=n.originalEvent;if(s){for(i in s){if(!(i in n)){n[i]=s[i]}}}this.element.trigger(n,r);return!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===false||n.isDefaultPrevented())}};e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){if(typeof i==="string"){i={effect:i}}var o,u=!i?t:i===true||typeof i==="number"?n:i.effect||n;i=i||{};if(typeof i==="number"){i={duration:i}}o=!e.isEmptyObject(i);i.complete=s;if(i.delay){r.delay(i.delay)}if(o&&e.effects&&e.effects.effect[u]){r[t](i)}else if(u!==t&&r[u]){r[u](i.duration,i.easing,s)}else{r.queue(function(n){e(this)[t]();if(s){s.call(r[0])}n()})}}})});!function(e){"use strict";var t=function(e,r){var i=/[^\w\-\.:]/.test(e)?new Function(t.arg+",tmpl","var _e=tmpl.encode"+t.helper+",_s='"+e.replace(t.regexp,t.func)+"';return _s;"):t.cache[e]=t.cache[e]||t(t.load(e));return r?i(r,t):function(e){return i(e,t)}};t.cache={},t.load=function(e){return document.getElementById(e).innerHTML},t.regexp=/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,t.func=function(e,t,n,r,i,s){return t?{"\n":"\\n","\r":"\\r","	":"\\t"," ":" "}[t]||"\\"+t:n?"="===n?"'+_e("+r+")+'":"'+"+r+"+'":i?"';":s?"_s+='":void 0},t.encReg=/[<>&"'\x00]/g,t.encMap={"<":"&lt;",">":"&gt;","&":"&",'"':"&quot;","'":"&#39;"},t.encode=function(e){return String(e).replace(t.encReg,function(e){return t.encMap[e]||""})},t.arg="o",t.helper=",print=function(s,e){_s+=e&&(s||'')||_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return t}):e.tmpl=t}(this);(function(e){"use strict";var t=function(e,n,r){var i,s,o=document.createElement("img");if(o.onerror=n,o.onload=function(){!s||r&&r.noRevoke||t.revokeObjectURL(s),n&&n(t.scale(o,r))},t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e))i=s=t.createObjectURL(e),o._type=e.type;else{if("string"!=typeof e)return!1;i=e,r&&r.crossOrigin&&(o.crossOrigin=r.crossOrigin)}return i?(o.src=i,o):t.readFile(e,function(e){var t=e.target;t&&t.result?o.src=t.result:n&&n(e)})},n=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transformCoordinates=function(){},t.getTransformedOptions=function(e){return e},t.renderImageToCanvas=function(e,t,n,r,i,s,o,u,a,f){return e.getContext("2d").drawImage(t,n,r,i,s,o,u,a,f),e},t.hasCanvasOption=function(e){return e.canvas||e.crop},t.scale=function(e,n){n=n||{};var r,i,s,o,u,a,f,l,c,h=document.createElement("canvas"),p=e.getContext||t.hasCanvasOption(n)&&h.getContext,d=e.naturalWidth||e.width,v=e.naturalHeight||e.height,m=d,g=v,y=function(){var e=Math.max((s||m)/m,(o||g)/g);e>1&&(m=Math.ceil(m*e),g=Math.ceil(g*e))},b=function(){var e=Math.min((r||m)/m,(i||g)/g);1>e&&(m=Math.ceil(m*e),g=Math.ceil(g*e))};return p&&(n=t.getTransformedOptions(n),f=n.left||0,l=n.top||0,n.sourceWidth?(u=n.sourceWidth,void 0!==n.right&&void 0===n.left&&(f=d-u-n.right)):u=d-f-(n.right||0),n.sourceHeight?(a=n.sourceHeight,void 0!==n.bottom&&void 0===n.top&&(l=v-a-n.bottom)):a=v-l-(n.bottom||0),m=u,g=a),r=n.maxWidth,i=n.maxHeight,s=n.minWidth,o=n.minHeight,p&&r&&i&&n.crop?(m=r,g=i,c=u/a-r/i,0>c?(a=i*u/r,void 0===n.top&&void 0===n.bottom&&(l=(v-a)/2)):c>0&&(u=r*a/i,void 0===n.left&&void 0===n.right&&(f=(d-u)/2))):((n.contain||n.cover)&&(s=r=r||s,o=i=i||o),n.cover?(b(),y()):(y(),b())),p?(h.width=m,h.height=g,t.transformCoordinates(h,n),t.renderImageToCanvas(h,e,f,l,u,a,0,0,m,g)):(e.width=m,e.height=g,e)},t.createObjectURL=function(e){return n?n.createObjectURL(e):!1},t.revokeObjectURL=function(e){return n?n.revokeObjectURL(e):!1},t.readFile=function(e,t,n){if(window.FileReader){var r=new FileReader;if(r.onload=r.onerror=t,n=n||"readAsDataURL",r[n])return r[n](e),r}return!1},"function"==typeof define&&define.amd?define(function(){return t}):e.loadImage=t})(this),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(e){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var t=e.renderImageToCanvas;e.detectSubsampling=function(e){var t,n;return e.width*e.height>1048576?(t=document.createElement("canvas"),t.width=t.height=1,n=t.getContext("2d"),n.drawImage(e,-e.width+1,0),0===n.getImageData(0,0,1,1).data[3]):!1},e.detectVerticalSquash=function(e,t){var n,r,i,s,o,u=e.naturalHeight||e.height,a=document.createElement("canvas"),f=a.getContext("2d");for(t&&(u/=2),a.width=1,a.height=u,f.drawImage(e,0,0),n=f.getImageData(0,0,1,u).data,r=0,i=u,s=u;s>r;)o=n[4*(s-1)+3],0===o?i=s:r=s,s=i+r>>1;return s/u||1},e.renderImageToCanvas=function(n,r,i,s,o,u,a,f,l,c){if("image/jpeg"===r._type){var h,p,d,v,m=n.getContext("2d"),g=document.createElement("canvas"),y=1024,b=g.getContext("2d");if(g.width=y,g.height=y,m.save(),h=e.detectSubsampling(r),h&&(i/=2,s/=2,o/=2,u/=2),p=e.detectVerticalSquash(r,h),h||1!==p){for(s*=p,l=Math.ceil(y*l/o),c=Math.ceil(y*c/u/p),f=0,v=0;u>v;){for(a=0,d=0;o>d;)b.clearRect(0,0,y,y),b.drawImage(r,i,s,o,u,-d,-v,o,u),m.drawImage(g,0,0,y,y,a,f,l,c),d+=y,a+=l;v+=y,f+=c}return m.restore(),n}}return t(n,r,i,s,o,u,a,f,l,c)}}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(e){"use strict";var t=e.hasCanvasOption;e.hasCanvasOption=function(e){return t(e)||e.orientation},e.transformCoordinates=function(e,t){var n=e.getContext("2d"),r=e.width,i=e.height,s=t.orientation;if(s)switch(s>4&&(e.width=i,e.height=r),s){case 2:n.translate(r,0),n.scale(-1,1);break;case 3:n.translate(r,i),n.rotate(Math.PI);break;case 4:n.translate(0,i),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-i);break;case 7:n.rotate(.5*Math.PI),n.translate(r,-i),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-r,0)}},e.getTransformedOptions=function(e){if(!e.orientation||1===e.orientation)return e;var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);switch(e.orientation){case 2:n.left=e.right,n.right=e.left;break;case 3:n.left=e.right,n.top=e.bottom,n.right=e.left,n.bottom=e.top;break;case 4:n.top=e.bottom,n.bottom=e.top;break;case 5:n.left=e.top,n.top=e.left,n.right=e.bottom,n.bottom=e.right;break;case 6:n.left=e.top,n.top=e.right,n.right=e.bottom,n.bottom=e.left;break;case 7:n.left=e.bottom,n.top=e.right,n.right=e.top,n.bottom=e.left;break;case 8:n.left=e.bottom,n.top=e.left,n.right=e.top,n.bottom=e.right}return e.orientation>4&&(n.maxWidth=e.maxHeight,n.maxHeight=e.maxWidth,n.minWidth=e.minHeight,n.minHeight=e.minWidth,n.sourceWidth=e.sourceHeight,n.sourceHeight=e.sourceWidth),n}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(e){"use strict";var t=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,n,r){r=r||{};var i=this,s=r.maxMetaDataSize||262144,o={},u=!(window.DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice);(u||!e.readFile(e.blobSlice.call(t,0,s),function(t){var s,u,f,l,c=t.target.result,h=new DataView(c),p=2,d=h.byteLength-4,v=p;if(65496===h.getUint16(0)){for(;d>p&&(s=h.getUint16(p),s>=65504&&65519>=s||65534===s);){if(u=h.getUint16(p+2)+2,p+u>h.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(f=e.metaDataParsers.jpeg[s])for(l=0;f.length>l;l+=1)f[l].call(i,h,p,u,o,r);p+=u,v=p}!r.disableImageHead&&v>6&&(o.imageHead=c.slice?c.slice(0,v):(new Uint8Array(c)).subarray(0,v))}else console.log("Invalid JPEG file: Missing JPEG marker.");n(o)},"readAsArrayBuffer"))&&n(o)}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],e):e(window.loadImage)}(function(e){"use strict";e.ExifMap=function(){return this},e.ExifMap.prototype.map={Orientation:274},e.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},e.getExifThumbnail=function(e,t,n){var r,i,s;if(!n||t+n>e.byteLength)return console.log("Invalid Exif data: Invalid thumbnail data."),void 0;for(r=[],i=0;n>i;i+=1)s=e.getUint8(t+i),r.push((16>s?"0":"")+s.toString(16));return"data:image/jpeg,%"+r.join("%")},e.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,n){return e.getUint16(t,n)},size:2},4:{getValue:function(e,t,n){return e.getUint32(t,n)},size:4},5:{getValue:function(e,t,n){return e.getUint32(t,n)/e.getUint32(t+4,n)},size:8},9:{getValue:function(e,t,n){return e.getInt32(t,n)},size:4},10:{getValue:function(e,t,n){return e.getInt32(t,n)/e.getInt32(t+4,n)},size:8}},e.exifTagTypes[7]=e.exifTagTypes[1],e.getExifValue=function(t,n,r,i,s,o){var u,a,f,l,c,h,p=e.exifTagTypes[i];if(!p)return console.log("Invalid Exif data: Invalid tag type."),void 0;if(u=p.size*s,a=u>4?n+t.getUint32(r+8,o):r+8,a+u>t.byteLength)return console.log("Invalid Exif data: Invalid data offset."),void 0;if(1===s)return p.getValue(t,a,o);for(f=[],l=0;s>l;l+=1)f[l]=p.getValue(t,a+l*p.size,o);if(p.ascii){for(c="",l=0;f.length>l&&(h=f[l],"\0"!==h);l+=1)c+=h;return c}return f},e.parseExifTag=function(t,n,r,i,s){var o=t.getUint16(r,i);s.exif[o]=e.getExifValue(t,n,r,t.getUint16(r+2,i),t.getUint32(r+4,i),i)},e.parseExifTags=function(e,t,n,r,i){var s,o,u;if(n+6>e.byteLength)return console.log("Invalid Exif data: Invalid directory offset."),void 0;if(s=e.getUint16(n,r),o=n+2+12*s,o+4>e.byteLength)return console.log("Invalid Exif data: Invalid directory size."),void 0;for(u=0;s>u;u+=1)this.parseExifTag(e,t,n+2+12*u,r,i);return e.getUint32(o,r)},e.parseExifData=function(t,n,r,i,s){if(!s.disableExif){var o,u,a,f=n+10;if(1165519206===t.getUint32(n+4)){if(f+8>t.byteLength)return console.log("Invalid Exif data: Invalid segment size."),void 0;if(0!==t.getUint16(n+8))return console.log("Invalid Exif data: Missing byte alignment offset."),void 0;switch(t.getUint16(f)){case 18761:o=!0;break;case 19789:o=!1;break;default:return console.log("Invalid Exif data: Invalid byte alignment marker."),void 0}if(42!==t.getUint16(f+2,o))return console.log("Invalid Exif data: Missing TIFF marker."),void 0;u=t.getUint32(f+4,o),i.exif=new e.ExifMap,u=e.parseExifTags(t,f,f+u,o,i),u&&!s.disableExifThumbnail&&(a={exif:{}},u=e.parseExifTags(t,f,f+u,o,a),a.exif[513]&&(i.exif.Thumbnail=e.getExifThumbnail(t,f+a.exif[513],a.exif[514]))),i.exif[34665]&&!s.disableExifSub&&e.parseExifTags(t,f,f+i.exif[34665],o,i),i.exif[34853]&&!s.disableExifGps&&e.parseExifTags(t,f,f+i.exif[34853],o,i)}}},e.metaDataParsers.jpeg[65505].push(e.parseExifData)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],e):e(window.loadImage)}(function(e){"use strict";var t,n,r;e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return t+""},t=e.ExifMap.prototype.tags,n=e.ExifMap.prototype.map;for(r in t)t.hasOwnProperty(r)&&(n[t[r]]=r);e.ExifMap.prototype.getAll=function(){var e,n,r={};for(e in this)this.hasOwnProperty(e)&&(n=t[e],n&&(r[n]=this.getText(n)));return r}});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","jquery.ui.widget"],e)}else{e(window.jQuery)}})(function(e){"use strict";e.support.fileInput=!((new RegExp("(Android (1\\.[0156]|2\\.[01]))"+"|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)"+"|(w(eb)?OSBrowser)|(webOS)"+"|(Kindle/(1\\.0|2\\.[05]|3\\.0))")).test(window.navigator.userAgent)||e('<input type="file">').prop("disabled"));e.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);e.support.xhrFormDataFileUpload=!!window.FormData;e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,n){t=this.messages[t]||t.toString();if(n){e.each(n,function(e,n){t=t.replace("{"+e+"}",n)})}return t},formData:function(e){return e.serializeArray()},add:function(t,n){if(t.isDefaultPrevented()){return false}if(n.autoUpload||n.autoUpload!==false&&e(this).fileupload("option","autoUpload")){n.process().done(function(){n.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.loaded=0;this.bitrate=0;this.getBitrate=function(e,t,n){var r=e-this.timestamp;if(!this.bitrate||!n||r>n){this.bitrate=(t-this.loaded)*(1e3/r)*8;this.loaded=t;this.timestamp=e}return this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;if(e.type(t.formData)==="function"){return t.formData(t.form)}if(e.isArray(t.formData)){return t.formData}if(e.type(t.formData)==="object"){n=[];e.each(t.formData,function(e,t){n.push({name:e,value:t})});return n}return[]},_getTotal:function(t){var n=0;e.each(t,function(e,t){n+=t.size||1});return n},_initProgressObject:function(t){var n={loaded:0,total:0,bitrate:0};if(t._progress){e.extend(t._progress,n)}else{t._progress=n}},_initResponseObject:function(e){var t;if(e._response){for(t in e._response){if(e._response.hasOwnProperty(t)){delete e._response[t]}}}else{e._response={}}},_onProgress:function(t,n){if(t.lengthComputable){var r=Date.now?Date.now():(new Date).getTime(),i;if(n._time&&n.progressInterval&&r-n._time<n.progressInterval&&t.loaded!==t.total){return}n._time=r;i=Math.floor(t.loaded/t.total*(n.chunkSize||n._progress.total))+(n.uploadedBytes||0);this._progress.loaded+=i-n._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,n.bitrateInterval);n._progress.loaded=n.loaded=i;n._progress.bitrate=n.bitrate=n._bitrateTimer.getBitrate(r,i,n.bitrateInterval);this._trigger("progress",e.Event("progress",{delegatedEvent:t}),n);this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var n=this,r=t.xhr?t.xhr():e.ajaxSettings.xhr();if(r.upload){e(r.upload).bind("progress",function(e){var r=e.originalEvent;e.lengthComputable=r.lengthComputable;e.loaded=r.loaded;e.total=r.total;n._onProgress(e,t)});t.xhr=function(){return r}}},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var n=this,r,i=t.files[0],s=t.multipart||!e.support.xhrFileUpload,o=e.type(t.paramName)==="array"?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers);if(t.contentRange){t.headers["Content-Range"]=t.contentRange}if(!s||t.blob||!this._isInstanceOf("File",i)){t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"'}if(!s){t.contentType=i.type||"application/octet-stream";t.data=t.blob||i}else if(e.support.xhrFormDataFileUpload){if(t.postMessage){r=this._getFormData(t);if(t.blob){r.push({name:o,value:t.blob})}else{e.each(t.files,function(n,i){r.push({name:e.type(t.paramName)==="array"&&t.paramName[n]||o,value:i})})}}else{if(n._isInstanceOf("FormData",t.formData)){r=t.formData}else{r=new FormData;e.each(this._getFormData(t),function(e,t){r.append(t.name,t.value)})}if(t.blob){r.append(o,t.blob,i.name)}else{e.each(t.files,function(i,s){if(n._isInstanceOf("File",s)||n._isInstanceOf("Blob",s)){r.append(e.type(t.paramName)==="array"&&t.paramName[i]||o,s,s.uploadName||s.name)}})}}t.data=r}t.blob=null},_initIframeSettings:function(t){var n=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||"");t.formData=this._getFormData(t);if(t.redirect&&n&&n!==location.host){t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})}},_initDataSettings:function(e){if(this._isXHRUpload(e)){if(!this._chunkedUpload(e,true)){if(!e.data){this._initXHRData(e)}this._initProgressListener(e)}if(e.postMessage){e.dataType="postmessage "+(e.dataType||"")}}else{this._initIframeSettings(e)}},_getParamName:function(t){var n=e(t.fileInput),r=t.paramName;if(!r){r=[];n.each(function(){var t=e(this),n=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;while(i){r.push(n);i-=1}});if(!r.length){r=[n.prop("name")||"files[]"]}}else if(!e.isArray(r)){r=[r]}return r},_initFormSettings:function(t){if(!t.form||!t.form.length){t.form=e(t.fileInput.prop("form"));if(!t.form.length){t.form=e(this.options.fileInput.prop("form"))}}t.paramName=this._getParamName(t);if(!t.url){t.url=t.form.prop("action")||location.href}t.type=(t.type||e.type(t.form.prop("method"))==="string"&&t.form.prop("method")||"").toUpperCase();if(t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"){t.type="POST"}if(!t.formAcceptCharset){t.formAcceptCharset=t.form.attr("accept-charset")}},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);this._initFormSettings(n);this._initDataSettings(n);return n},_getDeferredState:function(e){if(e.state){return e.state()}if(e.isResolved()){return"resolved"}if(e.isRejected()){return"rejected"}return"pending"},_enhancePromise:function(e){e.success=e.done;e.error=e.fail;e.complete=e.always;return e},_getXHRPromise:function(t,n,r){var i=e.Deferred(),s=i.promise();n=n||this.options.context||s;if(t===true){i.resolveWith(n,r)}else if(t===false){i.rejectWith(n,r)}s.abort=i.promise;return this._enhancePromise(s)},_addConvenienceMethods:function(t,n){var r=this,i=function(t){return e.Deferred().resolveWith(r,t).promise()};n.process=function(t,s){if(t||s){n._processQueue=this._processQueue=(this._processQueue||i([this])).pipe(function(){if(n.errorThrown){return e.Deferred().rejectWith(r,[n]).promise()}return i(arguments)}).pipe(t,s)}return this._processQueue||i([this])};n.submit=function(){if(this.state()!=="pending"){n.jqXHR=this.jqXHR=r._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==false&&r._onSend(t,this)}return this.jqXHR||r._getXHRPromise()};n.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}this.errorThrown="abort";r._trigger("fail",null,this);return r._getXHRPromise(false)};n.state=function(){if(this.jqXHR){return r._getDeferredState(this.jqXHR)}if(this._processQueue){return r._getDeferredState(this._processQueue)}};n.processing=function(){return!this.jqXHR&&this._processQueue&&r._getDeferredState(this._processQueue)==="pending"};n.progress=function(){return this._progress};n.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),r=n&&n.length>1&&parseInt(n[1],10);return r&&r+1},_chunkedUpload:function(t,n){t.uploadedBytes=t.uploadedBytes||0;var r=this,i=t.files[0],s=i.size,o=t.uploadedBytes,u=t.maxChunkSize||s,a=this._blobSlice,f=e.Deferred(),l=f.promise(),c,h;if(!(this._isXHRUpload(t)&&a&&(o||u<s))||t.data){return false}if(n){return true}if(o>=s){i.error=t.i18n("uploadedBytes");return this._getXHRPromise(false,t.context,[null,"error",i.error])}h=function(){var n=e.extend({},t),l=n._progress.loaded;n.blob=a.call(i,o,o+u,i.type);n.chunkSize=n.blob.size;n.contentRange="bytes "+o+"-"+(o+n.chunkSize-1)+"/"+s;r._initXHRData(n);r._initProgressListener(n);c=(r._trigger("chunksend",null,n)!==false&&e.ajax(n)||r._getXHRPromise(false,n.context)).done(function(i,u,a){o=r._getUploadedBytes(a)||o+n.chunkSize;if(l+n.chunkSize-n._progress.loaded){r._onProgress(e.Event("progress",{lengthComputable:true,loaded:o-n.uploadedBytes,total:o-n.uploadedBytes}),n)}t.uploadedBytes=n.uploadedBytes=o;n.result=i;n.textStatus=u;n.jqXHR=a;r._trigger("chunkdone",null,n);r._trigger("chunkalways",null,n);if(o<s){h()}else{f.resolveWith(n.context,[i,u,a])}}).fail(function(e,t,i){n.jqXHR=e;n.textStatus=t;n.errorThrown=i;r._trigger("chunkfail",null,n);r._trigger("chunkalways",null,n);f.rejectWith(n.context,[e,t,i])})};this._enhancePromise(l);l.abort=function(){return c.abort()};h();return l},_beforeSend:function(e,t){if(this._active===0){this._trigger("start");this._bitrateTimer=new this._BitrateTimer;this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(t);this._initProgressObject(t);t._progress.loaded=t.loaded=t.uploadedBytes||0;t._progress.total=t.total=this._getTotal(t.files)||1;t._progress.bitrate=t.bitrate=0;this._active+=1;this._progress.loaded+=t.loaded;this._progress.total+=t.total},_onDone:function(t,n,r,i){var s=i._progress.total,o=i._response;if(i._progress.loaded<s){this._onProgress(e.Event("progress",{lengthComputable:true,loaded:s,total:s}),i)}o.result=i.result=t;o.textStatus=i.textStatus=n;o.jqXHR=i.jqXHR=r;this._trigger("done",null,i)},_onFail:function(e,t,n,r){var i=r._response;if(r.recalculateProgress){this._progress.loaded-=r._progress.loaded;this._progress.total-=r._progress.total}i.jqXHR=r.jqXHR=e;i.textStatus=r.textStatus=t;i.errorThrown=r.errorThrown=n;this._trigger("fail",null,r)},_onAlways:function(e,t,n,r){this._trigger("always",null,r)},_onSend:function(t,n){if(!n.submit){this._addConvenienceMethods(t,n)}var r=this,i,s,o,u,a=r._getAJAXSettings(n),f=function(){r._sending+=1;a._bitrateTimer=new r._BitrateTimer;i=i||((s||r._trigger("send",e.Event("send",{delegatedEvent:t}),a)===false)&&r._getXHRPromise(false,a.context,s)||r._chunkedUpload(a)||e.ajax(a)).done(function(e,t,n){r._onDone(e,t,n,a)}).fail(function(e,t,n){r._onFail(e,t,n,a)}).always(function(e,t,n){r._onAlways(e,t,n,a);r._sending-=1;r._active-=1;if(a.limitConcurrentUploads&&a.limitConcurrentUploads>r._sending){var i=r._slots.shift();while(i){if(r._getDeferredState(i)==="pending"){i.resolve();break}i=r._slots.shift()}}if(r._active===0){r._trigger("stop")}});return i};this._beforeSend(t,a);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending){if(this.options.limitConcurrentUploads>1){o=e.Deferred();this._slots.push(o);u=o.pipe(f)}else{this._sequence=this._sequence.pipe(f,f);u=this._sequence}u.abort=function(){s=[undefined,"abort","abort"];if(!i){if(o){o.rejectWith(a.context,s)}return f()}return i.abort()};return this._enhancePromise(u)}return f()},_onAdd:function(t,n){var r=this,i=true,s=e.extend({},this.options,n),o=n.files,u=o.length,a=s.limitMultiFileUploads,f=s.limitMultiFileUploadSize,l=s.limitMultiFileUploadSizeOverhead,c=0,h=this._getParamName(s),p,d,v,m,g=0;if(f&&(!u||o[0].size===undefined)){f=undefined}if(!(s.singleFileUploads||a||f)||!this._isXHRUpload(s)){v=[o];p=[h]}else if(!(s.singleFileUploads||f)&&a){v=[];p=[];for(m=0;m<u;m+=a){v.push(o.slice(m,m+a));d=h.slice(m,m+a);if(!d.length){d=h}p.push(d)}}else if(!s.singleFileUploads&&f){v=[];p=[];for(m=0;m<u;m=m+1){c+=o[m].size+l;if(m+1===u||c+o[m+1].size+l>f||a&&m+1-g>=a){v.push(o.slice(g,m+1));d=h.slice(g,m+1);if(!d.length){d=h}p.push(d);g=m+1;c=0}}}else{p=h}n.originalFiles=o;e.each(v||o,function(s,o){var u=e.extend({},n);u.files=v?o:[o];u.paramName=p[s];r._initResponseObject(u);r._initProgressObject(u);r._addConvenienceMethods(t,u);i=r._trigger("add",e.Event("add",{delegatedEvent:t}),u);return i});return i},_replaceFileInput:function(t){var n=t.clone(true);e("<form></form>").append(n)[0].reset();t.after(n).detach();e.cleanData(t.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(e,r){if(r===t[0]){return n[0]}return r});if(t[0]===this.element[0]){this.element=n}},_handleFileTreeEntry:function(t,n){var r=this,i=e.Deferred(),s=function(e){if(e&&!e.entry){e.entry=t}i.resolve([e])},o;n=n||"";if(t.isFile){if(t._file){t._file.relativePath=n;i.resolve(t._file)}else{t.file(function(e){e.relativePath=n;i.resolve(e)},s)}}else if(t.isDirectory){o=t.createReader();o.readEntries(function(e){r._handleFileTreeEntries(e,n+t.name+"/").done(function(e){i.resolve(e)}).fail(s)},s)}else{i.resolve([])}return i.promise()},_handleFileTreeEntries:function(t,n){var r=this;return e.when.apply(e,e.map(t,function(e){return r._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var n=t.items;if(n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)){return this._handleFileTreeEntries(e.map(n,function(e){var t;if(e.webkitGetAsEntry){t=e.webkitGetAsEntry();if(t){t._file=e.getAsFile()}return t}return e.getAsEntry()}))}return e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var n=t.prop("webkitEntries")||t.prop("entries"),r,i;if(n&&n.length){return this._handleFileTreeEntries(n)}r=e.makeArray(t.prop("files"));if(!r.length){i=t.prop("value");if(!i){return e.Deferred().resolve([]).promise()}r=[{name:i.replace(/^.*\\/,"")}]}else if(r[0].name===undefined&&r[0].fileName){e.each(r,function(e,t){t.name=t.fileName;t.size=t.fileSize})}return e.Deferred().resolve(r).promise()},_getFileInputFiles:function(t){if(!(t instanceof e)||t.length===1){return this._getSingleFileInputFiles(t)}return e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(t){var n=this,r={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(r.fileInput).always(function(i){r.files=i;if(n.options.replaceFileInput){n._replaceFileInput(r.fileInput)}if(n._trigger("change",e.Event("change",{delegatedEvent:t}),r)!==false){n._onAdd(t,r)}})},_onPaste:function(t){var n=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};if(n&&n.length){e.each(n,function(e,t){var n=t.getAsFile&&t.getAsFile();if(n){r.files.push(n)}});if(this._trigger("paste",e.Event("paste",{delegatedEvent:t}),r)!==false){this._onAdd(t,r)}}},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=this,r=t.dataTransfer,i={};if(r&&r.files&&r.files.length){t.preventDefault();this._getDroppedFiles(r).always(function(r){i.files=r;if(n._trigger("drop",e.Event("drop",{delegatedEvent:t}),i)!==false){n._onAdd(t,i)}})}},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=t.dataTransfer;if(n&&e.inArray("Files",n.types)!==-1&&this._trigger("dragover",e.Event("dragover",{delegatedEvent:t}))!==false){t.preventDefault();n.dropEffect="copy"}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if(e.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(t,n){var r=e.inArray(t,this._specialOptions)!==-1;if(r){this._destroyEventHandlers()}this._super(t,n);if(r){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var t=this.options;if(t.fileInput===undefined){t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else if(!(t.fileInput instanceof e)){t.fileInput=e(t.fileInput)}if(!(t.dropZone instanceof e)){t.dropZone=e(t.dropZone)}if(!(t.pasteZone instanceof e)){t.pasteZone=e(t.pasteZone)}},_getRegExp:function(e){var t=e.split("/"),n=t.pop();t.shift();return new RegExp(t.join("/"),n)},_isRegExpOption:function(t,n){return t!=="url"&&e.type(n)==="string"&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var t=this,n=this.options;e.each(e(this.element[0].cloneNode(false)).data(),function(e,r){if(t._isRegExpOption(e,r)){r=t._getRegExp(r)}n[e]=r})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var n=this;if(!t||this.options.disabled){return}if(t.fileInput&&!t.files){this._getFileInputFiles(t.fileInput).always(function(e){t.files=e;n._onAdd(null,t)})}else{t.files=e.makeArray(t.files);this._onAdd(null,t)}},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n=this,r=e.Deferred(),i=r.promise(),s,o;i.abort=function(){o=true;if(s){return s.abort()}r.reject(null,"abort","abort");return i};this._getFileInputFiles(t.fileInput).always(function(e){if(o){return}if(!e.length){r.reject();return}t.files=e;s=n._onSend(null,t).then(function(e,t,n){r.resolve(e,t,n)},function(e,t,n){r.reject(e,t,n)})});return this._enhancePromise(i)}t.files=e.makeArray(t.files);if(t.files.length){return this._onSend(null,t)}}return this._getXHRPromise(false,t&&t.context)}})});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fileupload"],e)}else{e(window.jQuery)}})(function(e){"use strict";var t=e.blueimp.fileupload.prototype.options.add;e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{processQueue:[],add:function(n,r){var i=e(this);r.process(function(){return i.fileupload("process",r)});t.call(this,n,r)}},processActions:{},_processFile:function(t){var n=this,r=e.Deferred().resolveWith(n,[t]),i=r.promise();this._trigger("process",null,t);e.each(t.processQueue,function(e,t){var r=function(e){return n.processActions[t.action].call(n,e,t)};i=i.pipe(r,t.always&&r)});i.done(function(){n._trigger("processdone",null,t);n._trigger("processalways",null,t)}).fail(function(){n._trigger("processfail",null,t);n._trigger("processalways",null,t)});return i},_transformProcessQueue:function(t){var n=[];e.each(t.processQueue,function(){var r={},i=this.action,s=this.prefix===true?i:this.prefix;e.each(this,function(n,i){if(e.type(i)==="string"&&i.charAt(0)==="@"){r[n]=t[i.slice(1)||(s?s+n.charAt(0).toUpperCase()+n.slice(1):n)]}else{r[n]=i}});n.push(r)});t.processQueue=n},processing:function(){return this._processing},process:function(t){var n=this,r=e.extend({},this.options,t);if(r.processQueue&&r.processQueue.length){this._transformProcessQueue(r);if(this._processing===0){this._trigger("processstart")}e.each(t.files,function(t){var i=t?e.extend({},r):r,s=function(){return n._processFile(i)};i.index=t;n._processing+=1;n._processingQueue=n._processingQueue.pipe(s,s).always(function(){n._processing-=1;if(n._processing===0){n._trigger("processstop")}})})}return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=e.Deferred().resolveWith(this).promise()}})});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","load-image","load-image-meta","load-image-exif","load-image-ios","canvas-to-blob","./jquery.fileupload-process"],e)}else{e(window.jQuery,window.loadImage)}})(function(e,t){"use strict";e.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:true,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"});e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png)$/,loadImageMaxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:false,imageCrop:false,disableImageResize:true,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:true,previewThumbnail:true,previewCrop:false,previewCanvas:true},processActions:{loadImage:function(n,r){if(r.disabled){return n}var i=this,s=n.files[n.index],o=e.Deferred();if(e.type(r.maxFileSize)==="number"&&s.size>r.maxFileSize||r.fileTypes&&!r.fileTypes.test(s.type)||!t(s,function(e){if(e.src){n.img=e}o.resolveWith(i,[n])},r)){return n}return o.promise()},resizeImage:function(n,r){if(r.disabled||!(n.canvas||n.img)){return n}r=e.extend({canvas:true},r);var i=this,s=e.Deferred(),o=r.canvas&&n.canvas||n.img,u=function(e){if(e&&(e.width!==o.width||e.height!==o.height||r.forceResize)){n[e.getContext?"canvas":"img"]=e}n.preview=e;s.resolveWith(i,[n])},a;if(n.exif){if(r.orientation===true){r.orientation=n.exif.get("Orientation")}if(r.thumbnail){a=n.exif.get("Thumbnail");if(a){t(a,u,r);return s.promise()}}}if(o){u(t.scale(o,r));return s.promise()}return n},saveImage:function(t,n){if(!t.canvas||n.disabled){return t}var r=this,i=t.files[t.index],s=e.Deferred();if(t.canvas.toBlob){t.canvas.toBlob(function(e){if(!e.name){if(i.type===e.type){e.name=i.name}else if(i.name){e.name=i.name.replace(/\..+$/,"."+e.type.substr(6))}}if(i.type!==e.type){delete t.imageHead}t.files[t.index]=e;s.resolveWith(r,[t])},n.type||i.type,n.quality)}else{return t}return s.promise()},loadImageMetaData:function(n,r){if(r.disabled){return n}var i=this,s=e.Deferred();t.parseMetaData(n.files[n.index],function(t){e.extend(n,t);s.resolveWith(i,[n])},r);return s.promise()},saveImageMetaData:function(e,t){if(!(e.imageHead&&e.canvas&&e.canvas.toBlob&&!t.disabled)){return e}var n=e.files[e.index],r=new Blob([e.imageHead,this._blobSlice.call(n,20)],{type:n.type});r.name=n.name;e.files[e.index]=r;return e},setImage:function(e,t){if(e.preview&&!t.disabled){e.files[e.index][t.name||"preview"]=e.preview}return e},deleteImageReferences:function(e,t){if(!t.disabled){delete e.img;delete e.canvas;delete e.preview;delete e.imageHead}return e}}})});(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","tmpl","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],e)}else{e(window.jQuery,window.tmpl)}})(function(e,t){"use strict";e.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId");e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{autoUpload:false,uploadTemplateId:"template-upload",downloadTemplateId:"template-download",filesContainer:undefined,prependFiles:false,dataType:"json",getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(t){if(t.result&&e.isArray(t.result.files)){return t.result.files}return[]},add:function(t,n){if(t.isDefaultPrevented()){return false}var r=e(this),i=r.data("blueimp-fileupload")||r.data("fileupload"),s=i.options;n.context=i._renderUpload(n.files).data("data",n).addClass("processing");s.filesContainer[s.prependFiles?"prepend":"append"](n.context);i._forceReflow(n.context);e.when(i._transition(n.context),n.process(function(){return r.fileupload("process",n)})).always(function(){n.context.each(function(t){e(this).find(".size").text(i._formatFileSize(n.files[t].size))}).removeClass("processing");i._renderPreviews(n)}).done(function(){n.context.find(".start").prop("disabled",false);if(i._trigger("added",t,n)!==false&&(s.autoUpload||n.autoUpload)&&n.autoUpload!==false){n.submit()}}).fail(function(){if(n.files.error){n.context.each(function(t){var r=n.files[t].error;if(r){e(this).find(".error").text(r)}})}})},send:function(t,n){if(t.isDefaultPrevented()){return false}var r=e(this).data("blueimp-fileupload")||e(this).data("fileupload");if(n.context&&n.dataType&&n.dataType.substr(0,6)==="iframe"){n.context.find(".progress").addClass(!e.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%")}return r._trigger("sent",t,n)},done:function(t,n){if(t.isDefaultPrevented()){return false}var r=e(this).data("blueimp-fileupload")||e(this).data("fileupload"),i=n.getFilesFromResponse||r.options.getFilesFromResponse,s=i(n),o,u;if(n.context){n.context.each(function(i){var a=s[i]||{error:"Empty file upload result"};u=r._addFinishedDeferreds();r._transition(e(this)).done(function(){var i=e(this);o=r._renderDownload([a]).replaceAll(i);r._forceReflow(o);r._transition(o).done(function(){n.context=e(this);r._trigger("completed",t,n);r._trigger("finished",t,n);u.resolve()})})})}else{o=r._renderDownload(s)[r.options.prependFiles?"prependTo":"appendTo"](r.options.filesContainer);r._forceReflow(o);u=r._addFinishedDeferreds();r._transition(o).done(function(){n.context=e(this);r._trigger("completed",t,n);r._trigger("finished",t,n);u.resolve()})}},fail:function(t,n){if(t.isDefaultPrevented()){return false}var r=e(this).data("blueimp-fileupload")||e(this).data("fileupload"),i,s;if(n.context){n.context.each(function(o){if(n.errorThrown!=="abort"){var u=n.files[o];u.error=u.error||n.errorThrown||true;s=r._addFinishedDeferreds();r._transition(e(this)).done(function(){var o=e(this);i=r._renderDownload([u]).replaceAll(o);r._forceReflow(i);r._transition(i).done(function(){n.context=e(this);r._trigger("failed",t,n);r._trigger("finished",t,n);s.resolve()})})}else{s=r._addFinishedDeferreds();r._transition(e(this)).done(function(){e(this).remove();r._trigger("failed",t,n);r._trigger("finished",t,n);s.resolve()})}})}else if(n.errorThrown!=="abort"){n.context=r._renderUpload(n.files)[r.options.prependFiles?"prependTo":"appendTo"](r.options.filesContainer).data("data",n);r._forceReflow(n.context);s=r._addFinishedDeferreds();r._transition(n.context).done(function(){n.context=e(this);r._trigger("failed",t,n);r._trigger("finished",t,n);s.resolve()})}else{r._trigger("failed",t,n);r._trigger("finished",t,n);r._addFinishedDeferreds().resolve()}},progress:function(t,n){if(t.isDefaultPrevented()){return false}var r=Math.floor(n.loaded/n.total*100);if(n.context){n.context.each(function(){e(this).find(".progress").attr("aria-valuenow",r).children().first().css("width",r+"%")})}},progressall:function(t,n){if(t.isDefaultPrevented()){return false}var r=e(this),i=Math.floor(n.loaded/n.total*100),s=r.find(".fileupload-progress"),o=s.find(".progress-extended");if(o.length){o.html((r.data("blueimp-fileupload")||r.data("fileupload"))._renderExtendedProgress(n))}s.find(".progress").attr("aria-valuenow",i).children().first().css("width",i+"%")},start:function(t){if(t.isDefaultPrevented()){return false}var n=e(this).data("blueimp-fileupload")||e(this).data("fileupload");n._resetFinishedDeferreds();n._transition(e(this).find(".fileupload-progress")).done(function(){n._trigger("started",t)})},stop:function(t){if(t.isDefaultPrevented()){return false}var n=e(this).data("blueimp-fileupload")||e(this).data("fileupload"),r=n._addFinishedDeferreds();e.when.apply(e,n._getFinishedDeferreds()).done(function(){n._trigger("stopped",t)});n._transition(e(this).find(".fileupload-progress")).done(function(){e(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%");e(this).find(".progress-extended").html("&nbsp;");r.resolve()})},processstart:function(t){if(t.isDefaultPrevented()){return false}e(this).addClass("fileupload-processing")},processstop:function(t){if(t.isDefaultPrevented()){return false}e(this).removeClass("fileupload-processing")},destroy:function(t,n){if(t.isDefaultPrevented()){return false}var r=e(this).data("blueimp-fileupload")||e(this).data("fileupload"),i=function(){r._transition(n.context).done(function(){e(this).remove();r._trigger("destroyed",t,n)})};if(n.url){n.dataType=n.dataType||r.options.dataType;e.ajax(n).done(i).fail(function(){r._trigger("destroyfailed",t,n)})}else{i()}}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(t){if(!t){t=e.Deferred()}this._finishedUploads.push(t);return t},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var t=e(this),n=t.prop("href"),r=t.prop("download"),i="application/octet-stream";t.bind("dragstart",function(e){try{e.originalEvent.dataTransfer.setData("DownloadURL",[i,r,n].join(":"))}catch(t){}})},_formatFileSize:function(e){if(typeof e!=="number"){return""}if(e>=1e9){return(e/1e9).toFixed(2)+" GB"}if(e>=1e6){return(e/1e6).toFixed(2)+" MB"}return(e/1e3).toFixed(2)+" KB"},_formatBitrate:function(e){if(typeof e!=="number"){return""}if(e>=1e9){return(e/1e9).toFixed(2)+" Gbit/s"}if(e>=1e6){return(e/1e6).toFixed(2)+" Mbit/s"}if(e>=1e3){return(e/1e3).toFixed(2)+" kbit/s"}return e.toFixed(2)+" bit/s"},_formatTime:function(e){var t=new Date(e*1e3),n=Math.floor(e/86400);n=n?n+"d ":"";return n+("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)},_formatPercentage:function(e){return(e*100).toFixed(2)+" %"},_renderExtendedProgress:function(e){return this._formatBitrate(e.bitrate)+" | "+this._formatTime((e.total-e.loaded)*8/e.bitrate)+" | "+this._formatPercentage(e.loaded/e.total)+" | "+this._formatFileSize(e.loaded)+" / "+this._formatFileSize(e.total)},_renderTemplate:function(t,n){if(!t){return e()}var r=t({files:n,formatFileSize:this._formatFileSize,options:this.options});if(r instanceof e){return r}return e(this.options.templatesContainer).html(r).children()},_renderPreviews:function(t){t.context.find(".preview").each(function(n,r){e(r).append(t.files[n].preview)})},_renderUpload:function(e){return this._renderTemplate(this.options.uploadTemplate,e)},_renderDownload:function(e){return this._renderTemplate(this.options.downloadTemplate,e).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(t){t.preventDefault();var n=e(t.currentTarget),r=n.closest(".template-upload"),i=r.data("data");n.prop("disabled",true);if(i&&i.submit){i.submit()}},_cancelHandler:function(t){t.preventDefault();e(".newpost .start").toggle();var n=e(t.currentTarget).closest(".template-upload,.template-download"),r=n.data("data")||{};r.context=r.context||n;if(r.abort){r.abort()}else{r.errorThrown="abort";this._trigger("fail",t,r)}},_deleteHandler:function(t){t.preventDefault();var n=e(t.currentTarget);this._trigger("destroy",t,e.extend({context:n.closest(".template-download"),type:"DELETE"},n.data()))},_forceReflow:function(t){return e.support.transition&&t.length&&t[0].offsetWidth},_transition:function(t){var n=e.Deferred();if(e.support.transition&&t.hasClass("fade")&&t.is(":visible")){t.bind(e.support.transition.end,function(r){if(r.target===t[0]){t.unbind(e.support.transition.end);n.resolveWith(t)}}).toggleClass("in")}else{t.toggleClass("in");n.resolveWith(t)}return n},_initButtonBarEventHandlers:function(){var t=this.element.find(".fileupload-buttonbar"),n=this.options.filesContainer;this._on(t.find(".start"),{click:function(e){e.preventDefault();n.find(".start").click()}});this._on(t.find(".cancel"),{click:function(e){e.preventDefault();n.find(".cancel").click()}});this._on(t.find(".delete"),{click:function(e){e.preventDefault();n.find(".toggle:checked").closest(".template-download").find(".delete").click();t.find(".toggle").prop("checked",false)}});this._on(t.find(".toggle"),{change:function(t){n.find(".toggle").prop("checked",e(t.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click");this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super();this._on(this.options.filesContainer,{"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler});this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,"click");this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",false).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",true).parent().addClass("disabled")},_initTemplates:function(){var e=this.options;e.templatesContainer=this.document[0].createElement(e.filesContainer.prop("nodeName"));if(t){if(e.uploadTemplateId){e.uploadTemplate=t(e.uploadTemplateId)}if(e.downloadTemplateId){e.downloadTemplate=t(e.downloadTemplateId)}}},_initFilesContainer:function(){var t=this.options;if(t.filesContainer===undefined){t.filesContainer=this.element.find(".files")}else if(!(t.filesContainer instanceof e)){t.filesContainer=e(t.filesContainer)}},_initSpecialOptions:function(){this._super();this._initFilesContainer();this._initTemplates()},_create:function(){this._super();this._resetFinishedDeferreds();if(!e.support.fileInput){this._disableFileInputButton()}},enable:function(){var e=false;if(this.options.disabled){e=true}this._super();if(e){this.element.find("input, button").prop("disabled",false);this._enableFileInputButton()}},disable:function(){if(!this.options.disabled){this.element.find("input, button").prop("disabled",true);this._disableFileInputButton()}this._super()}})});window.locale={fileupload:{errors:{maxFileSize:"File is too big",minFileSize:"File is too small",acceptFileTypes:"Filetype not allowed",maxNumberOfFiles:"Max number of files exceeded",uploadedBytes:"Uploaded bytes exceed file size",emptyResult:"Empty file upload result"},error:gettext("error"),publish:gettext("publish"),cancel:gettext("cancel"),destroy:gettext("destroy")}};(function(e){function t(t){var r=t.skinDir+"/"+t.skin,i=a[r];if(i)i.loaded?n.call(this,t,i.html):i.queue.push({c:this,s:t});else{a[r]={loaded:false,queue:[{c:this,s:t}]};e.ajax({url:r+".html",dataType:"text",success:function(e){var t=a[r];t.loaded=true;t.html=e;for(e=0;e<t.queue.length;e++)n.call(t.queue[e].c,t.queue[e].s,t.html)},dataFilter:function(e){return e=e.substring(e.indexOf("<body>")+6,e.lastIndexOf("</body>"))},error:function(){if(t.error){var n=e.Event("tn3_error");n.description="tn3 skin load error";t.error(n)}}})}return this}function n(t,n){this.each(function(){for(var r=e(this),i,s,o=n.indexOf("<img src=");o!=-1;){o+=10;s=n.indexOf('"',o);i=t.skinDir+"/"+n.substring(o,s);n=n.substr(0,o)+i+n.substr(s);o=n.indexOf("<img src=",o)}r.append(n);r.data("tn3").init(r,t.fullOnly)})}function r(t){var n=[],r=t.children(".tn3.album"),o,u;if(r.length>0)r.each(function(t){o=e(this);n[t]={title:o.find(":header").html()};e.extend(n[t],s(o));if(u=i(o)){n[t].imgs=u;if(!n[t].thumb)n[t].thumb=n[t].imgs[0].thumb}});else if(u=i(t))n[0]={imgs:u};return n}function i(t){var n=[],r,i;r=t.children("ol,ul").children("li");if(r.length>0)r.each(function(t){i=e(this);$firsta=i.find("a:not(.tn3 > a)").filter(":first");n[t]={title:i.find(":header").filter(":first").html()};if($firsta.length>0){n[t].img=$firsta.attr("href");n[t].thumb=$firsta.find("img").attr("src")}else n[t].img=i.find("img").filter(":first").attr("src");e.extend(n[t],s(i));n[t].alt=i.find("img").filter(":first").attr("alt")||n[t].title});else{r=t.find("img");r.each(function(t){i=e(this);$at=i.parent("a");n[t]=$at.length==0?{title:i.attr("title"),img:i.attr("src")}:{title:i.attr("title"),img:$at.attr("href"),thumb:i.attr("src")};n[t].alt=i.attr("alt")||n[t].title})}if(n.length==0)return null;return n}function s(t){var n={};t=t.children(".tn3");var r;e.each(t,function(){r=e(this);n[r.attr("class").substr(4)]=r.html()});return n}function o(t){e('a[href^="#tn3-'+t+'"]').click(function(n){var r=f[t];n=e(n.currentTarget).attr("href");n=n.substr(n.indexOf("-",5)+1);n=n.split("-");switch(n[0]){case"next":r.cAlbum!=null&&r.show("next",n[1]=="fs");break;case"prev":r.cAlbum!=null&&r.show("prev",n[1]=="fs");break;default:r.cAlbum!=parseInt(n[0])?r.showAlbum(parseInt(n[0]),parseInt(n[1]),n[2]=="fs"):r.show(parseInt(n[1]),n[2]=="fs")}})}function u(){if(f.length==0){var t=e(".tn3gallery");t.length>0&&t.tn3({})}}if(function(t){for(var n,r,i=e.fn.jquery,s=i.split(".");t.length<s.length;)t.push(0);for(n=0;n<t.length;n++){r=parseInt(s[n]);if(r>t[n])return true;if(r<t[n])return false}return i===t.join(".")}([1,4,2])){var a={},f=[];e.fn.tn3=function(i){e.each(["skin","startWithAlbums","external"],function(e,t){var n=t.split(".");if(n.length>1&&i[n[0]])delete i[n[0]][n[1]];else delete i[t]});i=e.extend(true,{},e.fn.tn3.config,i);if(i.skin!=null)if(typeof i.skin=="object"){i.skinDir+="/"+i.skin[0];if(i.cssID==null)i.cssID=i.skin[0];i.skin=i.skin[1]}else i.skinDir+="/"+i.skin;else{i.skin="tn3";i.skinDir+="/tn3";e.fn.tn3.dontLoad=true}if(i.cssID==null)i.cssID=i.skin==null?"tn3":i.skin;this.each(function(){var t=e(this);i.fullOnly?t.hide():t.css("visibility","hidden");var n=i.data?i.data:r(t);n=f.push(new e.fn.tn3.Gallery(n,i))-1;t.data("tn3",f[n]);for(var s=0;s<e.fn.tn3.plugins.length;s++)e.fn.tn3.plugins[s].init(t,i,f[n]);t.empty();o(n)});e.fn.tn3.dontLoad?n.call(this,i,i.skinDefault):t.call(this,i);return this};e.fn.tn3.plugins=[];e.fn.tn3.plugIn=function(t,n){e.fn.tn3.plugins.push({id:t,init:n})};e.fn.tn3.version="1.4.0.103";e.fn.tn3.config={data:null,skin:null,skinDir:"skins",skinDefault:'<div class="tn3-gallery"><div class="tn3-image"><div class="tn3-text-bg"><div class="tn3-image-title"></div><div class="tn3-image-description"></div></div><div class="tn3-next tn3_v tn3_o"></div><div class="tn3-prev tn3_v tn3_o"></div><div class="tn3-preloader tn3_h tn3_v"></div><div class="tn3-timer"></div></div><div class="tn3-controls-bg tn3_rh"><div class="tn3-sep1"></div><div class="tn3-sep2"></div><div class="tn3-sep3"></div></div><div class="tn3-thumbs"></div><div class="tn3-fullscreen"></div><div class="tn3-show-albums"></div><div class="tn3-next-page"></div><div class="tn3-prev-page"></div><div class="tn3-play"></div><div class="tn3-count"></div><div class="tn3-albums"><div class="tn3-inalbums"><div class="tn3-album"></div></div><div class="tn3-albums-next"></div><div class="tn3-albums-prev"></div><div class="tn3-albums-close"></div></div></div>',cssID:null};e.fn.tn3.translations={};e.fn.tn3.translate=function(t,n){if(n)e.fn.tn3.translations[t]=n;else{var r=e.fn.tn3.translations[t];return r?r:t}};e(function(){setTimeout(u,1)})}else alert("tn3gallery requires jQuery v1.4.2 or later!  You are using v"+e.fn.jquery)})(jQuery);(function(e){e.fn.tn3utils=U={};U.shuffle=function(e){var t,n,r=e.length;if(r)for(;--r;){n=Math.floor(Math.random()*(r+1));t=e[n];e[n]=e[r];e[r]=t}};e.extend(e.easing,{def:"easeOutQuad",swing:function(t,n,r,s,o){return e.easing[e.easing.def](t,n,r,s,o)},linear:function(e,t,n,r,i){return r*t/i+n},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t+n;return-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t+n;return r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t*t+n;return-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){if((t/=i/2)<1)return r/2*t*t*t*t*t+n;return r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){if(t==0)return n;if(t==i)return n+r;if((t/=i/2)<1)return r/2*Math.pow(2,10*(t-1))+n;return r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){if((t/=i/2)<1)return-r/2*(Math.sqrt(1-t*t)-1)+n;return r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){e=1.70158;var s=0,o=r;if(t==0)return n;if((t/=i)==1)return n+r;s||(s=i*.3);if(o<Math.abs(r)){o=r;e=s/4}else e=s/(2*Math.PI)*Math.asin(r/o);return-(o*Math.pow(2,10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s))+n},easeOutElastic:function(e,t,n,r,i){e=1.70158;var s=0,o=r;if(t==0)return n;if((t/=i)==1)return n+r;s||(s=i*.3);if(o<Math.abs(r)){o=r;e=s/4}else e=s/(2*Math.PI)*Math.asin(r/o);return o*Math.pow(2,-10*t)*Math.sin((t*i-e)*2*Math.PI/s)+r+n},easeInOutElastic:function(e,t,n,r,i){e=1.70158;var s=0,o=r;if(t==0)return n;if((t/=i/2)==2)return n+r;s||(s=i*.3*1.5);if(o<Math.abs(r)){o=r;e=s/4}else e=s/(2*Math.PI)*Math.asin(r/o);if(t<1)return-.5*o*Math.pow(2,10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s)+n;return o*Math.pow(2,-10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s)*.5+r+n},easeInBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;return r*(t/=i)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;return r*((t=t/i-1)*t*((s+1)*t+s)+1)+n},easeInOutBack:function(e,t,n,r,i,s){if(s==undefined)s=1.70158;if((t/=i/2)<1)return r/2*t*t*(((s*=1.525)+1)*t-s)+n;return r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n},easeInBounce:function(t,n,r,s,o){return s-e.easing.easeOutBounce(t,o-n,0,s,o)+r},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,r,s,o){if(n<o/2)return e.easing.easeInBounce(t,n*2,0,s,o)*.5+r;return e.easing.easeOutBounce(t,n*2-o,0,s,o)*.5+s*.5+r}})})(jQuery);(function(e){e.fn.tn3.Gallery=function(t,n){this.data=t;this.config=e.extend(true,{},e.fn.tn3.Gallery.config,n);this.initialized=false;this.t=e.fn.tn3.translate;this.loader=new e.fn.tn3.External(n.external,this)};e.fn.tn3.Gallery.config={cssID:"tn3",active:[],inactive:[],iniAlbum:0,iniImage:0,imageClick:"next",startWithAlbums:false,autoplay:false,delay:7e3,timerMode:"bar",timerSteps:300,timerStepChar:"&#8226;",isFullScreen:false,fullOnly:false,width:null,height:null,mouseWheel:true,keyNavigation:"fullscreen",timerOverStop:true,responsive:false,useNativeFullScreen:true,autohideControls:false,autohideOver:true,overFadeDuration:300,spinjs:null,image:{},thumbnailer:{},touch:{}};e.fn.tn3.Gallery.prototype={config:null,$c:null,$tn3:null,data:null,thumbnailer:null,imager:null,cAlbum:null,timer:null,items:null,initialized:null,n:null,albums:null,loader:null,fso:null,timerSize:null,special:null,areHidden:false,$inImage:null,isPlaying:false,cparent:null,spinner:null,showInit:false,init:function(n,r){this.$c=n;if(!(this.loader.reqs>0||this.data.length==0||r)){this.trigger("init_start");this.config.useNativeFullScreen=this.config.useNativeFullScreen&&t.supportsFullScreen;this.config.fullOnly&&this.$c.show();this.$c.css("visibility","visible");this.$tn3=this.$c.find("."+this.config.cssID+"-gallery");var i=this.config.initValues={width:this.$tn3.width(),height:this.$tn3.height()};this.$tn3.css("float","left");i.wDif=this.$tn3.outerWidth(true)-i.width;i.hDif=this.$tn3.outerHeight(true)-i.height;this.replaceMenu("tn3gallery.com","http://tn3gallery.com");var s=this;this.timer=new e.fn.tn3.Timer(this.$c,this.config.delay,this.config.timerSteps);this.$c.bind("tn3_timer_end",function(){s.show("next")});this.special={rv:[],rh:[],v:[],h:[],vi:[],hi:[],o:[],x:{}};this.parseLayout();this.center();e.each(this.items,function(t,n){switch(t){case"next":n.click(function(e){s.show("next");e.stopPropagation()});n.attr("title",s.t("Next Image"));break;case"prev":n.click(function(e){s.show("prev");e.stopPropagation()});n.attr("title",s.t("Previous Image"));break;case"next-page":n.click(function(){s.items.thumbs&&s.thumbnailer.next(true)});n.attr("title",s.t("Next Page"));break;case"prev-page":n.click(function(){s.items.thumbs&&s.thumbnailer.prev(true)});n.attr("title",s.t("Previous Page"));break;case"thumbs":s.config.thumbnailer.cssID=s.config.cssID;s.config.thumbnailer.initValues={width:n.width(),height:n.height()};s.config.thumbnailer.initValues.vertical=n.width()<=n.height();n.bind("tn_click",function(e){s.show(e.n)}).bind("tn_over",function(){s.timer.pause(true)}).bind("tn_out",function(){s.timer.pause(false)}).bind("tn_error",function(e){s.trigger("error",e)});break;case"image":s.config.image.cssID=s.config.cssID;s.config.image.initValues={width:n.width(),height:n.height()};n.bind("img_click",function(e){switch(s.config.imageClick){case"next":s.show("next");break;case"fullscreen":s.fullscreen(true);break;case"url":if(e=s.data[s.cAlbum].imgs[e.n].url.replace(/&/g,"&"))window.location=e}}).bind("img_load_start",function(){s.displayPreloader(true)}).bind("img_load_end",function(e){s.n=e.n;s.displayPreloader(false);s.items.timer&&s.items.timer.hide();s.$inImage&&s.$inImage.hide()}).bind("img_transition",function(e){s.setTextValues(false,"image");s.items.thumbs&&s.thumbnailer.thumbClick(s.n);s.$inImage&&s.imager.cached[e.n].isImage&&s.$inImage.fadeIn(300);s.items.count&&s.items.count.text(s.n+1+"/"+s.data[s.cAlbum].imgs.length);s.isPlaying&&s.timer.start();s.special.o.length>0&&s.config.autohideOver&&s.hideElements();if(s.config.autohideControls){if(s.items.prev)s.items.prev[e.n==0?"hide":"show"]();if(s.items.next)s.items.next[e.n==s.imager.data.length-1?"hide":"show"]()}}).bind("img_enter",function(){s.imageEnter()}).bind("img_leave",function(){s.imageLeave()}).bind("img_resize",function(e){if(s.$inImage){s.$inImage.width(e.w).height(e.h).css("left",e.left).css("top",e.top);s.center();s.imager.bindMouseEvents(s.$inImage)}}).bind("img_error",function(e){s.trigger("error",e)});break;case"preloader":s.config.spinjs&&n.find("img").remove();s.displayPreloader(false);break;case"timer":var r=n.width()>n.height()?"width":"height";s.$c.bind("timer_tick",function(e){if(s.config.timerMode=="char"){for(var t=s.config.timerStepChar;--e.tick;)t+=s.config.timerStepChar;s.items.timer.html(t)}else s.items.timer[r](s.timerSize/e.totalTicks*e.tick);s.trigger(e.type,e)}).bind("timer_start",function(e){s.timerSize=s.$inImage[r]();s.items.timer.fadeIn(300);s.items.play&&s.items.play.addClass(s.config.cssID+"-play-active");s.trigger(e.type,e)}).bind("timer_end timer_stop",function(e){s.items.timer.hide();e.type=="timer_end"&&s.n==s.data[s.cAlbum].imgs.length-1&&s.trigger("autoplay_finish");s.trigger(e.type,e)});n.hide();break;case"play":n.click(function(e){var t={id:"play",execute:true};s.trigger("control",t);if(s.isPlaying){if(t.execute){s.timer.stop();n.removeClass(s.config.cssID+"-play-active");n.attr("title",s.t("Start Slideshow"))}s.isPlaying=false}else{if(t.execute){s.timer.start();n.addClass(s.config.cssID+"-play-active");n.attr("title",s.t("Stop Slideshow"))}s.isPlaying=true}e.stopPropagation()});n.attr("title",s.t("Start Slideshow"));break;case"count":break;case"albums":s.albums=new e.fn.tn3.Albums(s.data,n,s.config.cssID);n.hide();n.bind("albums_binit",function(e){s.trigger(e.type,e)}).bind("albums_click",function(e){s.showAlbum(e.n);s.trigger(e.type,e)}).bind("albums_init",function(e){s.timer.pause(true);s.trigger(e.type,e)}).bind("albums_error",function(e){s.trigger("error",e)}).bind("albums_close",function(){s.timer.pause(false)});break;case"album":break;case"albums-next":s.albums&&s.albums.setControl("next",n);n.attr("title",s.t("Next Album Page"));break;case"albums-prev":s.albums&&s.albums.setControl("prev",n);n.attr("title",s.t("Previous Album Page"));break;case"albums-close":s.albums&&s.albums.setControl("close",n);n.attr("title",s.t("Close"));break;case"show-albums":n.click(function(e){s.items.albums&&s.albums.show(0,s.cAlbum,false,true);e.stopPropagation()});n.attr("title",s.t("Album List"));break;case"fullscreen":n.click(function(e){var t={id:"fullscreen",execute:true};s.trigger("control",t);t.execute&&s.fullscreen(true);e.stopPropagation()});n.attr("title",s.t("Maximize"));break;default:s.special.x[t]&&n.click(function(e){var r=!s.items[s.special.x[t]].is(":visible"),i={id:t,execute:true,active:r};s.trigger("control",i);if(i.execute){r?n.addClass(s.config.cssID+"-"+t+"-active"):n.removeClass(s.config.cssID+"-"+t+"-active");s.items[s.special.x[t]].toggle()}e.stopPropagation()})}});if(this.config.width!==null||this.config.height!==null){if(this.config.width==null)this.config.width=this.config.initValues.width;if(this.config.height==null)this.config.height=this.config.initValues.height;this.resize(this.config.width,this.config.height)}i=Math.min(this.config.iniAlbum,this.data.length-1);this.config.responsive!==false&&this.initResponsive(this.config.responsive);this.initialized=true;this.config.startWithAlbums&&this.data.length>1&&this.items.albums?this.albums.show():this.showAlbum(i,this.config.iniImage);this.config.isFullScreen&&this.onFullResize();if(this.config.autoplay)this.items.play?this.items.play.click():this.timer.start();this.trigger("init")}},parseLayout:function(){var t=this.items={},n=this.config,r=n.active,i=n.inactive,s=n.cssID.length+1,o=this,u=/MSIE/.test(navigator.userAgent),a,f;this.$c.find("div[class^='"+n.cssID+"-']").each(function(){a=e(this);f=a.attr("class").split(" ")[0].substr(s);if(e.inArray(f,i)!=-1)a.remove();else if(r.length==0||e.inArray(f,r)!=-1)t[f]=a;else f!="gallery"&&a.remove();if(a.parent().hasClass(n.cssID+"-image")){if(!o.$inImage){o.$inImage=e('<div class="tn3-in-image"></div>');a.parent().append(o.$inImage);if(u){var l=e("<div />");l.css("background-color","#fff").css("opacity",0).css("width","100%").css("height","100%");l.appendTo(o.$inImage)}o.$inImage.css("position","absolute").width(t.image.width()).height(t.image.height())}a.appendTo(o.$inImage)}this.className.indexOf("tn3_")!=-1&&o.addSpecial(f,this.className)});$cm=this.$c;e.each(["albums","album","album-next","album-prev","show-albums"],function(e,r){delete t[r];$cm.find("."+n.cssID+"-"+r).remove()});var l=e('<div title="Powered by TN3 Gallery"></div>');l.css("position","absolute").css("background-image","url('"+this.config.skinDir+"/tn3.png')").css("background-position","-258px -7px").css("bottom","14px").css("right","53px").css("cursor","pointer").width(40).height(18);l.appendTo(this.$c.find("."+n.cssID+"-gallery"));l.click(function(){window.location="http://tn3gallery.com"}).hover(function(){e(this).css("background-position","-258px -45px")},function(){e(this).css("background-position","-258px -7px")})},addSpecial:function(e,t){for(var n=t.split(" "),r,i=0;i<n.length;i++){r=n[i].split("_");if(r[0]=="tn3")if(r[1]=="x")this.special.x[e]=r[2];else{this.special[r[1]].push(e);if(r[1]=="rh"||r[1]=="rv")this.config.initValues[e]={w:this.items[e].width(),h:this.items[e].height()}}}},initHover:function(e,t){var n=this;e.hover(function(){e.addClass(n.config.cssID+"-"+t+"-over")},function(){e.removeClass(n.config.cssID+"-"+t+"-over")})},setTextValues:function(t,n){var r,i,s,o=n+"-";for(s in this.items)if(s.indexOf(o)==0){r=s.substr(o.length);if(r!="info"&&r!="prev"&&r!="next"){i=n=="image"?this.data[this.cAlbum].imgs[this.n]:this.data[this.cAlbum];if(!i||i[r]==undefined){i={};i[r]=""}else i[r]=e.trim(i[r]);r={field:r,text:i[r],data:i};this.trigger("set_text",r);if(t||r.text==undefined||r.text.length==0){this.items[s].html("");this.items[s].hide()}else{this.items[s].html(r.text);this.items[s].show()}}}},show:function(e,t){this.timer.stop();this.showInit=true;this.imager&&this.imager.show(e);t&&this.fullscreen()},setAlbumData:function(e,t){if(t)this.trigger("error",{description:t});else{for(var n=0,r=e.length;n<r;n++)this.data.push(e[n]);this.$c&&this.init(this.$c,this.config.fullOnly)}},setImageData:function(e,t,n){if(n)this.trigger("error",{description:n});else{this.displayPreloader(false);e={data:e};this.trigger("image_data",e);this.data[t].imgs=e.data;if(this.cAlbum==t)this.rebuild(e.data,this.showInit?0:this.config.iniImage)}},showAlbum:function(e,t,n){if(this.initialized){if(e>this.data.length)return;this.timer.stop();this.cAlbum=e;this.albums&&this.albums.hide();if(this.data[this.cAlbum].imgs===undefined)if(this.loader){this.loader.getImages(this.data[this.cAlbum].adata,this.cAlbum);this.displayPreloader(true)}else this.trigger("error",{description:"Wrong album id"});else this.rebuild(this.data[this.cAlbum].imgs,t)}else{this.config.iniAlbum=e;this.config.iniImage=t;this.init(this.$c,false)}n&&this.fullscreen()},rebuild:function(t,n){if(this.items.thumbs)if(this.thumbnailer)this.thumbnailer.rebuild(t);else this.thumbnailer=new e.fn.tn3.Thumbnailer(this.items.thumbs,t,this.config.thumbnailer);if(this.items.image)if(this.imager)this.imager.rebuild(t);else this.imager=new e.fn.tn3.Imager(this.items.image,t,this.config.image);this.setTextValues(true,"image");this.setTextValues(false,"album");this.trigger("rebuild",{album:this.cAlbum});this.show(n==null?0:n)},showElements:function(t){if(this.areHidden){var n=this,r;e.each(this.special.o,function(i,s){if(n.config.autohideControls){if(s=="prev"&&n.n==0)return true;if(s=="next"&&n.n==n.imager.data.length-1)return true}r=n.items[s];r.show();if(t&&e.support.opacity){r.stop(true);r.css("opacity",0);r.animate({opacity:1},{duration:t,queue:false})}});this.areHidden=false}},hideElements:function(t){if(!this.areHidden){var n=this,r;e.each(this.special.o,function(i,s){r=n.items[s];if(t&&e.support.opacity){r.stop(true);r.animate({opacity:0},{duration:t,complete:function(){r.hide()},queue:false})}else r.hide()});this.areHidden=true}},setData:function(e){if(this.items.thumbs)this.thumbnailer.data=e;if(this.items.imager)this.imager.data=e},exitFullScreen:function(){!t.isFullScreen()&&this.config.isFullScreen&&this.fullscreen()},nativeFS:false,fullscreen:function(n){if(this.config.isFullScreen){if(this.config.useNativeFullScreen&&this.nativeFS){t.cancelFullScreen(this.$c);document.removeEventListener(t.fullScreenEventName,e.proxy(this.exitFullScreen,this))}else{e(window).unbind("resize",this.onFullResize);e.tn3unblock()}if(this.config.responsive!==false)this.initResponsive(this.config.responsive);else this.config.width!==null||this.config.height!==null?this.resize(this.config.width,this.config.height):this.resize(this.config.initValues.width,this.config.initValues.height);if(this.items.fullscreen){this.items.fullscreen.removeClass(this.config.cssID+"-fullscreen-active");this.items.fullscreen.attr("title",this.t("Maximize"))}this.config.fullOnly&&this.$c.hide();this.config.isFullScreen=false;this.trigger("fullscreen",{fullscreen:false});this.config.keyNavigation=="fullscreen"&&e(document).unbind("keyup",this.listenKeys)}else{if(this.config.useNativeFullScreen&&n){document.addEventListener(t.fullScreenEventName,e.proxy(this.exitFullScreen,this),true);t.requestFullScreen(this.$tn3);this.nativeFS=true}else{e.tn3block({message:this.$tn3,cssID:this.config.cssID});e(window).bind("resize",e.proxy(this.onFullResize,this));this.nativeFS=false}this.config.fullOnly&&this.$c.show();this.config.isFullScreen=true;if(this.items.fullscreen){this.items.fullscreen.addClass(this.config.cssID+"-fullscreen-active");this.items.fullscreen.attr("title",this.t("Minimize"))}this.onFullResize();this.trigger("fullscreen",{fullscreen:true})}},listenKeys:function(e){if(e.keyCode==70)this.items.fullscreen.click();else if(this.items.albums&&this.albums.enabled){var t=0;switch(e.keyCode){case 27:this.albums.hide();break;case 39:t="r";break;case 37:t="l";break;case 38:t="u";break;case 40:t="d";break;case 32:t="p"}t&&this.albums.select(t)}else switch(e.keyCode){case 27:this.config.isFullScreen&&this.fullscreen(true);break;case 39:this.show("next");break;case 37:this.show("prev");break;case 38:this.items.albums&&this.albums.show(0,this.cAlbum,false,true);break;case 32:this.items.play.click()}},onFullResize:function(){if(this.config.useNativeFullScreen&&this.nativeFS)this.resize(window.screen.width,window.screen.height);else{var t=e(window),n=t.width();t=t.height();n-=this.config.initValues.wDif;t-=this.config.initValues.hDif;this.resize(n,t)}},resize:function(t,n){this.$tn3.width(t).height(n);var r=t-this.config.initValues.width,i=n-this.config.initValues.height,s,o,u=this;if(this.items.image){s=this.config.image.initValues.width+r;o=this.config.image.initValues.height+i;if(this.imager)this.imager.setSize(s,o);else{this.items.image.width(s).height(o);this.$inImage.width(s).height(o)}}if(this.items.thumbs){s=this.config.thumbnailer.initValues.width+r;o=this.config.thumbnailer.initValues.height+i;if(this.thumbnailer)this.thumbnailer.setSize(s,o);else this.config.thumbnailer.initValues.vertical?this.items.thumbs.height(o):this.items.thumbs.width(s)}if(this.items.albums){s=this.albums.initValues.width+r;o=this.albums.initValues.height+i;this.albums.changeSize(r,i)}e.each(this.special.rh,function(e,t){u.items[t].width(u.config.initValues[t].w+r)});e.each(this.special.rv,function(e,t){u.items[t].height(u.config.initValues[t].h+i)});this.center()},center:function(){var t,n=this,r=n.items.image.position();e.each(this.special.v,function(e,r){t=n.items[r];t.css("top",(t.parent().height()-t.height())/2)});e.each(this.special.h,function(e,r){t=n.items[r];t.css("left",(t.parent().width()-t.width())/2)});e.each(this.special.vi,function(e,i){t=n.items[i];t.css("top",r.top+(n.items.image.height()-t.height())/2)});e.each(this.special.hi,function(e,i){t=n.items[i];t.css("left",r.left+(n.items.image.width()-t.width())/2)});if(this.spinner){this.displayPreloader(true);this.displayPreloader(false)}},trigger:function(t,n){var r=e.Event("tn3_"+t),i;for(i in n)r[i]=n[i];if(n&&n.type!=undefined)r.type="tn3_"+t;r.source=this;this.$c.trigger(r);this.config[t]&&this.config[t].call(this,r);for(i in n)n[i]=r[i]},initMouseWheel:function(){var e=this,t=function(t){e.show((t.originalEvent.detail?-t.originalEvent.detail:t.originalEvent.wheelDelta)>0?"prev":"next");t.preventDefault()};this.$tn3.bind("mousewheel",t);this.$tn3.bind("DOMMouseScroll",t)},initResponsive:function(n){var r;if(typeof n=="number"){var i=e(window);r=function(){var e=i.width(),t=i.height();this.resize(e*n/100,t*n/100)}}else if(e.isFunction(n))r=n;else if(n!==false){var s=this.$c.parent(),o=(this.config.width==null?this.config.initValues.width:this.config.width)/(this.config.height==null?this.config.initValues.height:this.config.height),u=s.width(),a=s.height();r=n=="enabled"?function(){u=s.width();a=s.height();this.resize(u,a)}:n=="height"?function(){a=s.height();u=a*o;this.resize(u,a)}:function(){u=s.width();a=u/o;this.resize(u,a)}}var f=this,l=function(){if(f.config.useNativeFullScreen)t.isFullScreen()||e.proxy(r,f)();else e.proxy(r,f)()};e(window).bind("resize",l);l()},replaceMenu:function(t,n){var r='<div style="position:absolute;background-color:#fff;color: #000;padding:0px 4px 0px 4px;z-index:1010;font-family:sans-serif;font-size:12px;">&copy; <a href="'+n+'">'+t+"</a></div>";this.$tn3.bind("contextmenu",function(e){e.preventDefault()}).bind("mousedown",function(t){if(t.which==3){var i=e(r);e("body").append(i);i.css("left",t.pageX).css("top",t.pageY);i.find("a").mouseup(function(e){window.location=n;i.unbind(e)});e("body").mouseup(function(t){i.remove();e("body").unbind(t)})}})},imageEnter:function(){this.config.timerOverStop&&this.timer.pause(true);this.special.o.length>0&&this.showElements(this.config.overFadeDuration)},imageLeave:function(){this.config.timerOverStop&&this.timer.pause(false);this.special.o.length>0&&this.hideElements(this.config.overFadeDuration)},displayPreloader:function(e){if(this.items.preloader)if(e){this.items.preloader.show();if(this.config.spinjs)if(this.spinner)this.spinner.spin(this.items.preloader[0]);else this.spinner=(new Spinner(this.config.spinjs)).spin(this.items.preloader[0])}else{this.spinner&&this.spinner.stop();this.items.preloader.hide()}}};var t={supportsFullScreen:false,isFullScreen:function(){return false},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},n="webkit moz o ms khtml".split(" ");if(typeof document.cancelFullScreen!="undefined")t.supportsFullScreen=true;else for(var r=0,i=n.length;r<i;r++){t.prefix=n[r];if(typeof document[t.prefix+"CancelFullScreen"]!="undefined"){t.supportsFullScreen=true;break}}if(t.supportsFullScreen){t.fullScreenEventName=t.prefix+"fullscreenchange";t.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}};t.requestFullScreen=function(e){this.prefix==="webkit"&&e.css("float","none");return this.prefix===""?e[0].requestFullScreen():e[0][this.prefix+"RequestFullScreen"]()};t.cancelFullScreen=function(e){this.prefix==="webkit"&&e.css("float","left");return this.prefix===""?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}}})(jQuery);(function(e,t,n){function r(e,n){var r=t.createElement(e||"div"),i;for(i in n)r[i]=n[i];return r}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function s(e,t,n,r){var i=["opacity",t,~~(e*100),n,r].join("-");n=.01+n/r*100;r=Math.max(1-(1-e)/t*(100-n),e);var s=h.substring(0,h.indexOf("Animation")).toLowerCase();s=s&&"-"+s+"-"||"";return c[i]||(p.insertRule("@"+s+"keyframes "+i+"{0%{opacity:"+r+"}"+n+"%{opacity:"+e+"}"+(n+.01)+"%{opacity:1}"+(n+t)%100+"%{opacity:"+e+"}100%{opacity:"+r+"}}",p.cssRules.length),c[i]=1),i}function o(e,t){var r=e.style,i,s;if(r[t]!==n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(s=0;s<l.length;s++){i=l[s]+t;if(r[i]!==n)return i}}function u(e,t){for(var n in t)e.style[o(e,n)||n]=t[n];return e}function a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t],i;for(i in r)e[i]===n&&(e[i]=r[i])}return e}function f(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;){t.x+=e.offsetLeft;t.y+=e.offsetTop}return t}var l=["webkit","Moz","ms","O"],c={},h,p=function(){var e=r("style",{type:"text/css"});return i(t.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),d={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto"},v=function m(e){if(!this.spin)return new m(e);this.opts=a(e||{},m.defaults,d)};v.defaults={};a(v.prototype,{spin:function(e){this.stop();var t=this,n=t.opts,i=t.el=u(r(0,{className:n.className}),{position:"relative",width:0,zIndex:n.zIndex}),s=n.radius+n.length+n.width,o,a;e&&(e.insertBefore(i,e.firstChild||null),a=f(e),o=f(i),u(i,{left:(n.left=="auto"?a.x-o.x+(e.offsetWidth>>1):parseInt(n.left,10)+s)+"px",top:(n.top=="auto"?a.y-o.y+(e.offsetHeight>>1):parseInt(n.top,10)+s)+"px"}));i.setAttribute("aria-role","progressbar");t.lines(i,t.opts);if(!h){var l=0,c=n.fps,p=c/n.speed,d=(1-n.opacity)/(p*n.trail/100),v=p/n.lines;(function m(){l++;for(var e=n.lines;e;e--)t.opacity(i,n.lines-e,Math.max(1-(l+e*v)%p*d,n.opacity),n);t.timeout=t.el&&setTimeout(m,~~(1e3/c))})()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=n),this},lines:function(e,t){function n(e,n){return u(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*o+t.rotate)+"deg) translate("+t.radius+"px,0)",borderRadius:(t.corners*t.width>>1)+"px"})}for(var o=0,a;o<t.lines;o++){a=u(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:h&&s(t.opacity,t.trail,o,t.lines)+" "+1/t.speed+"s linear infinite"});t.shadow&&i(a,u(n("#000","0 0 4px #000"),{top:"2px"}));i(e,i(a,n(t.color,"0 0 1px rgba(0,0,0,.1)")))}return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});(function(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}var t=u(r("group"),{behavior:"url(#default#VML)"});!o(t,"transform")&&t.adj?(p.addRule(".spin-vml","behavior:url(#default#VML)"),v.prototype.lines=function(t,n){function r(){return u(e("group",{coordsize:a+" "+a,coordorigin:-o+" "+ -o}),{width:a,height:a})}function s(t,s,a){i(l,i(u(r(),{rotation:360/n.lines*t+"deg",left:~~s}),i(u(e("roundrect",{arcsize:n.corners}),{width:o,height:n.width,left:n.radius,top:-n.width>>1,filter:a}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}var o=n.length+n.width,a=2*o,f=-(n.width+n.length)*2+"px",l=u(r(),{position:"absolute",top:f,left:f});if(n.shadow)for(f=1;f<=n.lines;f++)s(f,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(f=1;f<=n.lines;f++)s(f);return i(t,l)},v.prototype.opacity=function(e,t,n,r){e=e.firstChild;r=r.shadow&&r.lines||0;e&&t+r<e.childNodes.length&&(e=e&&e.firstChild,e&&(e.opacity=n))}):h=o(t,"animation")})();typeof define=="function"&&define.amd?define(function(){return v}):e.Spinner=v})(window,document);(function(e){e.fn.tn3.Imager=function(t,n,r){this.$c=t;this.data=n;r.crop=false;this.config=e.extend(true,{},e.fn.tn3.Imager.config,r);this.init()};e.fn.tn3.Imager.config={transitions:null,defaultTransition:{type:"slide"},random:false,cssID:"tn3",maxZoom:1.4,crop:false,clickEvent:"click",idleDelay:3e3,stretch:true,dif:0};e.fn.tn3.Imager.prototype={config:null,$c:false,$ins:null,data:false,cached:null,active:-1,$active:false,$buffer:false,isInTransition:false,ts:null,cDim:null,qid:null,currentlyLoading:null,side:null,$ic:null,$binder:null,infoID:null,lastEnter:false,mouseCoor:{x:0,y:0},mouseIsOver:false,init:function(){this.$c.css("overflow","hidden");this.$c.css("position","relative");this.$ins=e('<div class="'+this.config.cssID+'-image-ins" style="position:absolute;width:100%;height:100%;"></div>');this.$c.prepend(this.$ins);this.bindMouseEvents(this.$c);this.cached=[];this.ts=new e.fn.tn3.Transitions(this.config.transitions,this.config.defaultTransition,this.config.random,this,"onTransitionEnd")},bindMouseEvents:function(t){this.unbindMouseEvents();var n=this;t.hover(function(){n.mouseIsOver=true;n.enterLeave("enter");n.startIdle();e(document).mousemove(e.proxy(n.onMouseMove,n))},function(){n.mouseIsOver=false;n.enterLeave("leave");n.stopIdle();e(document).unbind("mousemove",n.onMouseMove)});t[this.config.clickEvent](function(e){n.active==-1||n.isInTransition||e.target.tagName.toUpperCase()!="A"&&n.trigger("click",{n:n.active})});this.$binder=t},unbindMouseEvents:function(){this.$binder&&this.$binder.unbind("mouseenter mouseleave "+this.config.clickEvent);e(document).unbind("mousemove",this.onMouseMove);this.stopIdle()},startIdle:function(){this.stopIdle();var e=this;if(this.config.idleDelay>0)this.infoID=setTimeout(function(){e.enterLeave("leave");e.stopIdle()},this.config.idleDelay)},onMouseMove:function(e){this.mouseCoor={x:e.pageX,y:e.pageY};if(!this.isInTransition){this.infoID||this.enterLeave("enter");this.startIdle()}},stopIdle:function(){clearTimeout(this.infoID);this.infoID=null},enterLeave:function(e){this.lastEnter!=e&&this.trigger(e);this.lastEnter=e},show:function(t){if(this.isInTransition)this.qid=t;else{this.qid=null;if(t=="next"){t=this.active+1<this.data.length?this.active+1:0;this.side="left"}else if(t=="prev"){t=this.active>0?this.active-1:this.data.length-1;this.side="right"}else this.side=this.active>t?"right":"left";if(this.data[t]){this.trigger("load_start",{n:t});this.$buffer=e('<div class="'+this.config.cssID+'-image-in" style="position:absolute;overflow:hidden;"></div>');this.$buffer.css("visibility","hidden");this.$ins.prepend(this.$buffer);if(this.cached[this.currentlyLoading]!=undefined)this.cached[this.currentlyLoading].init=false;if(this.cached[t]!=undefined)if(this.cached[t].status=="loaded")this.initImage(t);else{this.cached[t].init=true;this.currentlyLoading=t}else this.startLoading(t,true)}}},startLoading:function(t,n){var r=typeof t=="number"?t:t=="next"?this.active+1:this.active-1;if(!(this.cached[r]!=undefined&&this.cached[r].status=="loaded"||this.data[r]==undefined)){this.cached[r]={isImage:true,status:"loading",init:n};this.currentlyLoading=r;if(this.data[r].content!=undefined){this.cached[r].isImage=false;this.onCacheLoad(e(e.trim(this.data[r].content)),r)}else this.cached[r].loader=new e.fn.tn3.ImageLoader(this.data[r].img,this,this.onCacheLoad,[r])}},onCacheLoad:function(e,t,n){this.cached[t].status="loaded";this.cached[t].isImage&&e.attr("alt",this.data[t].alt);this.cached[t].$content=e;n&&this.trigger("error",{description:n,n:t});this.cached[t].init&&this.initImage(t)},initImage:function(t){var n=this.cached[t].$content;this.currentlyLoading=null;this.active=t;if(!this.cDim)this.cDim={w:this.$c.width(),h:this.$c.height()};this.$buffer.width(this.cDim.w).height(this.cDim.h);var r=e('<div class="'+this.config.cssID+'-full-image" style="position:absolute"></div>');n.appendTo(r);this.$buffer.append(r);this.$buffer.data("ic",r);this.$buffer.data("img",n);this.resize(this.$buffer);r=[true];this.trigger("load_end",{n:t,content:n,isImage:this.cached[t].isImage,doTransition:r});r[0]&&this.initTransition()},initTransition:function(){this.$buffer.css("visibility","visible");if(this.$active!=false){this.isInTransition=true;this.unbindMouseEvents();if(this.mouseIsOver)e(document).mousemove(e.proxy(this.onMouseMove,this));else this.mouseCoor={x:0,y:0};this.lastEnter="leave";this.$active.find("video").length>0&&this.config.transitions&&this.config.transitions.length>0&&this.config.transitions[0].type==="translate"?this.ts.start(this.$active,this.$buffer,this.side,true):this.ts.start(this.$active,this.$buffer,this.side)}else{this.$active=this.$buffer;this.trigger("transition",{n:this.active})}this.startLoading(this.side=="right"?"prev":"next",false)},setSize:function(e,t){this.isInTransition&&this.ts.stop(this.$active,this.$buffer,this.ts.config);this.$c.width(e).height(t);this.cDim={w:this.$c.width(),h:this.$c.height()};if(this.$active){this.$active.width(e).height(t);this.resize(this.$active)}},resize:function(e){if(e.data("img")==undefined)this.trigger("resize",{w:this.cDim.w,h:this.cDim.h,left:0,top:0});else this.cached[this.active].isImage?this.resizeImage(e):this.resizeContent(e)},resizeImage:function(e){$img=e.data("img");$ic=e.data("ic");$img.width("auto").height("auto");e.data("scaled",false);var t=$img.width(),n=$img.height(),r=0,i=0,s={w:t,h:n,left:0,top:0};$img.attr("width",t).attr("height",n);if($img.get(0).tagName.toUpperCase()=="IMG"&&(t!=this.cDim.w||n!=this.cDim.h)){r=this.cDim.w/t;i=this.cDim.h/n;r=this.config.crop?Math.max(r,i):Math.min(r,i);r=Math.min(this.config.maxZoom,r);t=s.w=Math.round(t*r)-this.config.dif;n=s.h=Math.round(n*r)-this.config.dif;if(this.cDim.w>=t)r=s.left=(this.cDim.w-t)/2;else{r=-(t-this.cDim.w)*.5;s.w=this.cDim.w}if(this.cDim.h>n)i=s.top=(this.cDim.h-n)/2;else{i=-(n-this.cDim.h)*.5;s.h=this.cDim.h}$img.width(t).height(n);$img.attr("width",t).attr("height",n);$ic.width(t).height(n);e.data("scaled",true)}$ic.css("left",r).css("top",i);this.bindMouseEvents($ic);this.trigger("resize",s)},resizeContent:function(e){$ic=e.data("ic");$img=e.data("img");e.data("scaled",false);var t=$img.width(),n=$img.height(),r={w:t,h:n,left:0,top:0};if(this.config.stretch){$ic.width(this.cDim.w).height(this.cDim.h);$img.width(this.cDim.w).height(this.cDim.h);e.data("scaled",true)}else{r.left=(this.cDim.w-t)*.5;r.top=(this.cDim.h-n)*.5;$ic.css("left",r.left).css("top",r.top)}this.bindMouseEvents($ic);this.trigger("resize",r)},onTransitionEnd:function(){this.$active.remove();this.$active=this.$buffer;this.$active.css("width","+=1");this.isInTransition=false;this.trigger("transition",{n:this.active});this.bindMouseEvents(this.$binder);var t=this.$binder.offset();this.mouseIsOver=false;if(this.mouseCoor.x>=t.left&&this.mouseCoor.x<=t.left+this.$binder.width())if(this.mouseCoor.y>=t.top&&this.mouseCoor.y<=t.top+this.$binder.height()){this.lastEnter="leave";this.enterLeave("enter");this.startIdle();this.mouseIsOver=true;e(document).mousemove(e.proxy(this.onMouseMove,this))}this.qid!=null&&this.show(this.qid)},trigger:function(t,n){var r=e.Event("img_"+t),s;for(s in n)r[s]=n[s];r.source=this;this.$c.trigger(r);this.config[t]&&this.config[t].call(this,r)},destroy:function(){this.isInTransition&&this.ts.stop(this.$active,this.$buffer);this.$active&&this.$active.remove();this.$buffer.remove()},rebuild:function(e){this.quid=null;this.isInTransition&&this.ts.stop(this.$active,this.$buffer);this.$buffer&&this.$buffer.remove();this.cached=[];this.data=e;this.loader&&this.loader.cancel()}}})(jQuery);(function(e){e.fn.tn3.Thumbnailer=function(t,n,r){this.$c=t;this.data=n;this.config=e.extend({},e.fn.tn3.Thumbnailer.config,r);e(window).resize(e.proxy(this.onWinResize,this));this.init()};e.fn.tn3.Thumbnailer.config={overMove:true,buffer:20,speed:8,slowdown:50,shaderColor:"#000000",shaderOpacity:.5,shaderDuration:300,shaderOut:300,useTitle:false,seqLoad:true,align:1,mode:"thumbs",cssID:"tn3"};e.fn.tn3.Thumbnailer.prototype={config:null,$c:null,$oc:null,$ul:null,data:null,active:-1,listSize:0,containerSize:0,containerPadding:0,noBufSize:0,containerOffset:0,mcoor:"mouseX",edge:"left",size:"width",outerSize:"outerWidth",mouseX:0,mouseY:0,intID:false,pos:0,difference:0,cnt:1,thumbCount:-1,initialized:false,clickWhenReady:-1,loaders:null,lis:null,isVertical:null,marginDif:0,nloaded:0,firstToLoad:0,isTouch:false,init:function(){this.$c.css("position","absolute").css("cursor","progress");this.lis=[];this.loaders=[];this.initialized=false;this.$oc=e("<div />");this.$ul=e("<ul />");this.$oc.appendTo(this.$c);this.$oc.css("position","absolute").css("overflow","hidden").width(this.$c.width()).height(this.$c.height());this.$ul.appendTo(this.$oc);this.$ul.css("position","relative").css("margin","0px").css("padding","0px").css("border-width","0px").css("width","12000px").css("list-style","none");if(this.isVertical==null){this.isVertical=this.$c.width()<this.$c.height();if(this.isVertical=false){this.mcoor="mouseY";this.edge="top";this.size="height";this.outerSize="outerHeight"}else{this.mcoor="mouseX";this.edge="left";this.size="width";this.outerSize="outerWidth"}this.containerSize=this.$oc[this.size]();this.noBufSize=this.containerSize-2*this.config.buffer;this.containerOffset=this.$oc.offset()[this.edge];this.containerPadding=parseInt(this.$c.css("padding-"+this.edge))}this.listSize=0;if(navigator.userAgent.indexOf("MSIE")!=-1)this.config.seqLoad=false;this.data.length>0&&this.loadNextThumb()},loadNextThumb:function(){this.thumbCount++;var t=e("<li></li>");this.$ul.append(t);if(this.config.mode=="thumbs"){var n=this.data[this.thumbCount].thumb;if(n){this.loaders.push(new e.fn.tn3.ImageLoader(n,this,this.onLoadThumb,[t,this.thumbCount]));!this.config.seqLoad&&this.thumbCount<this.data.length-1&&this.loadNextThumb();return}else this.config.mode="bullets"}this.config.mode=="numbers"&&t.text(this.thumbCount+1);this.onLoadThumb(null,t,this.thumbCount)},onLoadThumb:function(t,n,r,s){this.lis[r]={li:n};n.addClass(this.config.cssID+"-thumb");n.css("float",this.isVertical?"none":"left");if(t){var o=this.lis[r].thumb=e(t);n.append(o);this.lis[r].pos=n.position()[this.edge]}this.config.useTitle&&this.data[r].title&&n.attr("title",this.data[r].title.replace(/\&/g,"&"));if(this.config.mode=="thumbs"&&this.config.shaderOpacity>0){this.lis[r].shade=e("<div/>");n.prepend(this.lis[r].shade);this.lis[r].shade.css("background-color",this.config.shaderColor).css("width",o.width()).css("height",o.height()).css("position","absolute")}this.initThumb(r);n.css("opacity",0);n.animate({opacity:1},1e3);this.listSize+=n[this.outerSize](true);if(!this.initialized){this.firstToLoad=r;this.initialized=true;this.initMouse(true)}s&&this.trigger("error",{description:s,n:r});this.trigger("thumbLoad",{n:r});this.nloaded++;if(this.nloaded<this.data.length){if(this.config.seqLoad||this.config.mode!="thumbs")this.loadNextThumb()}else{if(t)this.loaders=null;if(!this.config.seqLoad)for(t=0;t<this.lis.length;t++)this.lis[t].pos=this.lis[t].li.position()[this.edge];this.thumbsLoaded()}if(this.clickWhenReady==r){this.clickWhenReady=-1;this.thumbClick(r)}},initThumb:function(e){var t=this.lis[e];if(t.li){t.li.removeClass().addClass(this.config.cssID+"-thumb");if(t.shade){t.shade.stop();t.shade.css("opacity",this.config.shaderOpacity)}var n=this;t.li.click(function(){n.thumbClick(e);n.trigger("click",{n:e});return false});this.config.mode!="thumbs"&&t.li.hover(function(){n.mouseOver(e)},function(){n.mouseOver(-1)})}},lastOver:-1,mouseOver:function(e){if(e!=this.lastOver){if(this.lastOver!=-1&&this.lastOver!=this.active){t=this.lis[this.lastOver];t.li.removeClass(this.config.cssID+"-thumb-over");if(t.shade){t.shade.stop();t.shade.animate({opacity:this.config.shaderOpacity},{duration:this.config.shaderOut,easing:"easeOutCubic",queue:false})}this.trigger("thumbOut",{n:e})}this.lastOver=e;if(!(e==-1||e==this.active)){var t=this.lis[e];t.li.addClass(this.config.cssID+"-thumb-over");if(t.shade){t.shade.stop();t.shade.animate({opacity:0},{duration:this.config.shaderDuration,easing:"easeOutCubic",queue:false})}this.trigger("thumbOver",{n:e})}}},next:function(e){if(e)this.listSize>this.containerSize&&this.move(this.$ul.position()[this.edge]-this.containerSize);else{e=this.active+1;if(this.active==-1||this.active+1==this.data.length)e=0;this.thumbClick(e)}},prev:function(e){if(e)this.listSize>this.containerSize&&this.move(this.$ul.position()[this.edge]+this.containerSize);else{e=this.active-1;if(this.active==-1||this.active==0)e=this.data.length-1;this.thumbClick(e)}},move:function(e){var t={};t[this.edge]=Math.min(0,Math.max(e,-(this.listSize-this.containerSize)));this.$ul.stop();this.$ul.animate(t,300)},thumbClick:function(e){if(this.active==-1){if(this.thumbCount<e||e>this.lis.length-1||this.lis[e]==null){this.clickWhenReady=e;return}}else if(e==this.active)return;else this.initThumb(this.active);if(e=="next")e=this.active+1<this.data.length?this.active+1:0;else if(e=="prev")e=this.active>0?this.active-1:this.data.length-1;if(this.lis[e]){var t=this.lis[e];t.li.addClass(this.config.cssID+"-thumb-selected").unbind("click mouseenter mouseleave");t.shade&&t.shade.animate({opacity:0},this.config.shaderDuration);this.active=e;this.centerActive()}},centerActive:function(e){if(this.active!=-1){var t=this.lis[this.active].li,n=this.$ul.position()[this.edge]+t.position()[this.edge],r=t[this.outerSize]()/2;if(n+r>this.containerSize||n+r<0){t=10-t.position()[this.edge]+this.containerSize/2-r;t=Math.min(0,t);t=Math.max(t,-this.listSize+this.containerSize);n={};n[this.edge]=t;if(this.isTouch)this.$oc["scroll"+this.edge.substring(0,1).toUpperCase()+this.edge.substring(1)](-t);else e?this.$ul.css(n):this.$ul.animate(n,200)}}},thumbsLoaded:function(){this.$c.css("cursor","auto");this.$ul.css("width",this.listSize+"px");this.centerList();this.trigger("load")},centerList:function(e){if(this.listSize<this.containerSize){var t={};t[this.edge]=this.config.align?this.config.align==1?(this.containerSize-this.listSize)/2:this.containerSize-this.listSize:0;e||this.config.mode!="thumbs"?this.$ul.css(t):this.$ul.animate(t,300)}else{this.centerActive(e);if(this.$ul.position()[this.edge]>0)this.$ul.css(this.edge,0);else this.$ul.position()[this.edge]+this.listSize<this.containerSize&&this.$ul.css(this.edge,-(this.listSize-this.containerSize))}},initMouse:function(t){if(this.config.mode=="thumbs"){t=t?"bind":"unbind";this.$oc[t]("mouseenter",e.proxy(this.mouseenter,this));this.$oc[t]("mouseleave",e.proxy(this.mouseleave,this))}},mouseenter:function(){this.trigger("over");clearInterval(this.intID);var e=this;this.$ul.stop();this.$c.mousemove(this.mcoor=="mouseX"?function(t){e.mouseX=t.pageX-e.containerOffset}:function(t){e.mouseY=t.pageY-e.containerOffset});this.marginDif=parseInt(this.lis[this.firstToLoad].li.css("margin-"+this.edge));if(isNaN(this.marginDif))this.marginDif=0;e.intID=this.listSize>this.containerSize&&this.config.overMove?setInterval(function(){e.slide.call(e)},10):setInterval(function(){e.mouseTrack.call(e)},10)},mouseleave:function(){this.trigger("out");this.$c.unbind("mousemove");clearInterval(this.intID);var e=this;this.intID=setInterval(function(){e.slideOut.call(e)},10);this.mouseOver(-1)},slide:function(){this.cnt=1;var e=this[this.mcoor];if(e<=this.config.buffer)this.pos=0;else if(e>=this.containerSize-this.config.buffer)this.pos=this.containerSize-this.listSize-1;else{var t=this.containerSize*(e-this.config.buffer);t/=this.noBufSize;this.pos=t*(1-this.listSize/this.containerSize)}for(t=this.lis.length-1;t>-1;t--){var n=e-this.prevdx;if(n>=this.lis[t].pos&&n<this.lis[t].pos+this.lis[t].li[this.size]()){this.mouseOver(t);break}}e=this.prevdx-this.marginDif;this.difference=e-this.pos;e=Math.round(e-this.difference/this.config.speed);if(this.prevdx!=e){this.$ul.css(this.edge,e);this.prevdx=e}},prevdx:0,mouseTrack:function(){for(var e=this[this.mcoor],t=this.lis.length-1;t>-1;t--){var n=e-this.$ul.position()[this.edge];if(n>=this.lis[t].pos&&n<this.lis[t].pos+this.lis[t].li[this.size]()){this.mouseOver(t);break}}},clickOn:function(e){e=e[this.edge]-this.$ul.position()[this.edge]-this.$c.offset()[this.edge];for(var t=0;t<this.lis.length;t++){lpos=this.lis[t].li.position()[this.edge];if(e>=lpos&&e<lpos+this.lis[t].li[this.size]()){this.lis[t].li.click();break}}},slideOut:function(){if(this.config.slowdown!=0&&this.difference!=0){var e=this.$ul.position()[this.edge];this.difference=e-this.pos;this.$ul.css(this.edge,e-this.difference/(this.config.speed*this.cnt));this.cnt*=1+4/this.config.slowdown;if(this.cnt>=40){this.difference=0;this.cnt=1}}else{clearInterval(this.intID);this.intID=null}},trigger:function(t,n){var r=e.Event("tn_"+t),s;for(s in n)r[s]=n[s];r.source=this;this.$c.trigger(r);this.config[t]&&this.config[t].call(this,r)},destroy:function(){clearInterval(this.intID);this.$c.empty()},rebuild:function(t){clearInterval(this.intID);this.$c.empty();this.data=t;this.active=this.thumbCount=-1;this.nloaded=0;this.initMouse(false);this.loaders!==null&&e.each(this.loaders,function(e,t){t.cancel()});this.init()},setSize:function(e,t){if(this.config.mode=="thumbs"){this.isVertical?this.$c.height(t):this.$c.width(e);this.$oc.width(this.$c.width()).height(this.$c.height());this.containerSize=this.$oc[this.size]();this.noBufSize=this.containerSize-2*this.config.buffer;this.containerOffset=this.$oc.offset()[this.edge];this.initMouse(true);this.loaders===null&&this.centerList(true)}},onWinResize:function(){this.containerOffset=this.$oc.offset()[this.edge]}}})(jQuery);(function(e){e.fn.tn3.altLink=null;e.fn.tn3.ImageLoader=function(t,n,r,s){this.$img=e(new Image);s.unshift(this.$img);this.altLink=e.fn.tn3.altLink;n={url:t,context:n,callback:r,args:s};this.$img.bind("load",n,this.load);this.$img.bind("error",n,e.proxy(this.error,this));this.$img.attr("src",t)};e.fn.tn3.ImageLoader.prototype={$img:null,altLink:null,load:function(e){e.data.callback.apply(e.data.context,e.data.args);e.data.args[0].unbind("load").unbind("error")},error:function(t){if(this.altLink){this.altLink=null;this.$img.attr("src",e.fn.tn3.altLink+t.data.url)}else{t.data.args.push("image loading error: "+t.data.url);t.data.callback.apply(t.data.context,t.data.args);this.$img.unbind("load").unbind("error")}},cancel:function(){this.$img.unbind("load").unbind("error")}}})(jQuery);(function(e){e.fn.tn3.Timer=function(e,t,n){this.$target=e;this.duration=t;this.tickint=n};e.fn.tn3.Timer.prototype={$target:null,duration:null,id:null,runs:false,counter:null,countDuration:null,tickid:null,ticks:null,tickint:500,start:function(){if(!this.runs){this.runs=true;this.startCount(this.duration);this.trigger("timer_start")}},startCount:function(e){this.clean();this.countDuration=e;this.counter=+(new Date);var t=this;this.id=setTimeout(function(){t.clean.call(t);t.runs=false;t.trigger.call(t,"timer_end")},e);var n=this.duration/this.tickint;this.ticks=Math.round(e/n);this.tickid=setInterval(function(){t.ticks=Math.ceil((e-new Date+t.counter)/n);t.ticks>0&&t.trigger.call(t,"timer_tick",{tick:t.ticks,totalTicks:t.tickint})},n);this.trigger("timer_start");this.trigger("timer_tick",{tick:this.ticks,totalTicks:this.tickint})},stop:function(){this.clean();this.runs=false;this.trigger("timer_stop")},clean:function(){clearTimeout(this.id);this.id=null;clearInterval(this.tickid);this.elapsed=this.tickid=null},elapsed:null,pause:function(e){if(this.runs){if(e){this.clean();var t=this.duration/this.tickint;this.elapsed=Math.floor((+(new Date)-this.counter)/t)*t}else{if(this.elapsed==null)return;this.startCount(this.countDuration-this.elapsed);this.elapsed=null}this.trigger("timer_pause",{pause:e})}},trigger:function(t,n){var r=e.Event(t),s;for(s in n)r[s]=n[s];this.$target.trigger(r)}}})(jQuery);(function(e){var t=e.fn.tn3.Transitions=function(t,n,r,s,o){this.ts=t;this.def=e.extend(true,{},this[n.type+"Config"],n);if(!t)this.ts=[this.def];for(var u in this.ts)this.ts[u]=e.extend(true,{},this[this.ts[u].type+"Config"],this.ts[u]);this.random=r;this.end=e.proxy(s,o)},n=t.prototype={ts:null,def:{type:"slide"},random:false,gs:[],end:null,ct:null,counter:-1,setTransition:function(){if(this.ts.length==1)this.ct=this.ts[0];else{this.counter++;if(this.counter==this.ts.length)this.counter=0;this.random&&this.counter==0&&e.fn.tn3utils.shuffle(this.ts);this.ct=this.ts[this.counter]}},start:function(e,t,n,r){if(r)this.ct=this.def;else this.setTransition();if(this[this.ct.type+"Condition"]!==undefined&&!this[this.ct.type+"Condition"](e,t,this.ct))this.ct=this.def;this[this.ct.type](e,t,this.ct,n)},stop:function(e,t){this[this.ct.type+"Stop"](e,t,this.ct)},makeGrid:function(e,t,n){var r=e.width(),i=Math.round(r/t);r=r-i*t;var s=e.height(),o=Math.round(s/n);s=s-o*n;var u,a,f,l,c,h=0,p=0,d="url("+e.find("img").attr("src")+") no-repeat scroll -";for(u=0;u<t;u++){this.gs[u]=[];l=r>u?i+1:i;for(a=0;a<n;a++){f=e.append("<div></div>").find(":last");c=s>a?o+1:o;f.width(l).height(c).css("background",d+h+"px -"+p+"px").css("left",h).css("top",p).css("position","absolute");this.gs[u].push(f);p+=c}h+=l;p=0}e.find("img").remove()},stopGrid:function(){for(var e=0;e<this.gs.length;e++)for(var t=0;t<this.gs[e].length;t++){this.gs[e][t].clearQueue();this.gs[e][t].remove()}this.gs=[]},flatSort:function(e){for(var t=[],n=0;n<this.gs.length;n++)for(var r=0;r<this.gs[n].length;r++)t.push(this.gs[n][r]);e&&t.reverse();return t},randomSort:function(){var t=this.flatSort();e.fn.tn3utils.shuffle(t);return t},diagonalSort:function(e,t){for(var n=[],r=e>0?this.gs.length-1:0,i=t>0?0:this.gs[0].length-1;this.gs[r];){n.push(this.addDiagonal([],r,i,e,t));r-=e}r+=e;for(i+=t;this.gs[r][i];){n.push(this.addDiagonal([],r,i,e,t));i+=t}return n},addDiagonal:function(e,t,n,r,i){e.push(this.gs[t][n]);return this.gs[t+r]&&this.gs[t+r][n+i]?this.addDiagonal(e,t+r,n+i,r,i):e},circleSort:function(e){var t=[],n=this.gs.length,r=this.gs[0].length,i=[Math.floor(n/2),Math.floor(r/2)];n=n*r;r=[[1,0],[0,1],[-1,0],[0,-1]];var s=0,o=0,u;for(t.push(this.gs[i[0]][i[1]]);t.length<n;){for(u=0;u<=s;u++)this.addGridPiece(t,i,r[o]);if(o==r.length-1)o=0;else o++;s+=.5}e&&t.reverse();return t},addGridPiece:function(e,t,n){t[0]+=n[0];t[1]+=n[1];this.gs[t[0]]&&this.gs[t[0]][t[1]]&&e.push(this.gs[t[0]][t[1]])},getSlidePositions:function(e,t){var n={dir:t};switch(t){case"left":n.pos=e.outerWidth(true);break;case"right":n.pos=-e.outerWidth(true);n.dir="left";break;case"top":n.pos=-e.outerHeight(true);break;case"bottom":n.pos=e.outerHeight(true);n.dir="top"}return n},animateGrid:function(t,n,r,s,o,u,a){var f={duration:s,easing:r,complete:function(){e(this).remove()}};for(r=0;r<t.length;r++){s=e.easing[o](0,r,0,u,t.length);if(r==t.length-1){var l=this;f.complete=function(){e(this).remove();a.call(l)}}if(e.isArray(t[r]))for(var c in t[r])t[r][c].delay(s).animate(n[r],f);else t[r].delay(s).animate(n[r],f)}},getValueArray:function(t,n,r){var s=[],u=e.isArray(n),a=e.isArray(r),f;for(f=0;f<t;f++){o={};o[u?n[f%n.length]:n]=a?r[f%r.length]:r;s.push(o)}return s}};t.defined=[];t.define=function(e){for(var r in e)switch(r){case"type":t.defined.push(e.type);break;case"config":n[e.type+"Config"]=e.config;break;case"f":n[e.type]=e.f;break;case"stop":n[e.type+"Stop"]=e.stop;break;case"condition":n[e.type+"Condition"]=e.condition;break;default:n[r]=e[r]}};t.define({type:"none",config:{},f:function(){this.end()},stop:function(){this.end()}});t.define({type:"fade",config:{duration:300,easing:"easeInQuad"},f:function(e,t,n){var r=this;e.animate({opacity:0},n.duration,n.easing,function(){r.end()})},stop:function(e){e.stop();this.end()}});t.define({type:"slide",config:{duration:300,direction:"auto",easing:"easeInOutCirc"},f:function(e,t,n,r){r=this.getSlidePositions(t,n.direction=="auto"?r:n.direction);var i={},s={};t.css(r.dir,r.pos);i[r.dir]=0;t.animate(i,n.duration,n.easing,this.end);s[r.dir]=-r.pos;e.animate(s,n.duration,n.easing)},stop:function(e,t){t.stop();e.stop();e.css("left",0).css("top",0);t.css("left",0).css("top",0);this.end()}});t.define({type:"blinds",config:{duration:240,easing:"easeInQuad",direction:"vertical",parts:12,partDuration:100,partEasing:"easeInQuad",method:"fade",partDirection:"auto",cross:true},f:function(e,t,n,r){n.direction=="horizontal"?this.makeGrid(e,1,n.parts):this.makeGrid(e,n.parts,1);r=n.partDirection=="auto"?r:n.partDirection;e=this.flatSort(r=="left"||r=="top");var i;switch(n.method){case"fade":i=this.getValueArray(e.length,"opacity",0);break;case"scale":i=this.getValueArray(e.length,r=="left"?"width":"height","1px");break;case"slide":t=this.getSlidePositions(t,r);i=this.getValueArray(e.length,t.dir,n.cross?[t.pos,-t.pos]:t.pos)}this.animateGrid(e,i,n.partEasing,n.partDuration,n.easing,n.duration,this.blindsStop)},stop:function(){this.stopGrid();this.end()},condition:function(e,t){return!e.data("scaled")||!t.data("scaled")}});t.define({type:"grid",config:{duration:260,easing:"easeInQuad",gridX:7,gridY:5,sort:"diagonal",sortReverse:false,diagonalStart:"bl",method:"fade",partDuration:300,partEasing:"easeOutSine",partDirection:"left"},f:function(e,t,n,r){this.makeGrid(e,n.gridX,n.gridY);e=n.partDirection=="auto"?r:n.partDirection;var i,s;if(n.sort=="diagonal")switch(n.diagonalStart){case"tr":i=this.diagonalSort(1,1);break;case"tl":i=this.diagonalSort(-1,1);break;case"br":i=this.diagonalSort(1,-1);break;case"bl":i=this.diagonalSort(-1,-1)}else i=this[n.sort+"Sort"](n.sortReverse);switch(n.method){case"fade":s=this.getValueArray(i.length,"opacity",0);break;case"scale":s=this.getValueArray(i.length,e=="left"?"width":"height","1px")}this.animateGrid(i,s,n.partEasing,n.partDuration,n.easing,n.duration,this.gridStop)},stop:function(){this.stopGrid();this.end()},condition:function(e,t){return!e.data("scaled")||!t.data("scaled")}})})(jQuery);(function(e){function t(t){var r=t&&t.message!==undefined?t.message:undefined;t=e.extend({},e.tn3block.defaults,t||{});r=r===undefined?t.message:r;f&&n({});var s=t.baseZ,l=o||t.forceIframe?e('<iframe class="blockUI" style="z-index:'+s++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+t.iframeSrc+'"></iframe>'):e('<div class="blockUI" style="display:none"></div>'),c=e('<div class="blockUI '+t.cssID+'-overlay" style="z-index:'+s++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');s=e('<div class="blockUI '+t.blockMsgClass+' blockPage" style="z-index:'+s+';display:none;position:fixed"></div>');s.css("left","0px").css("top","0px");c.css(t.overlayCSS);c.css("position","fixed");if(o||t.forceIframe)l.css("opacity",0);var p=[l,c,s],d=e("body");e.each(p,function(){this.appendTo(d)});p=a&&(!e.boxModel||e("object,embed",null).length>0);if(u||p){t.allowBodyStretch&&e.boxModel&&e("html,body").css("height","100%");e.each([l,c,s],function(e,n){var r=n[0].style;r.position="absolute";if(e<2){r.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight)- (jQuery.boxModel?0:"+t.quirksmodeOffsetHack+') + "px"');r.setExpression("width",'jQuery.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"')}else if(t.centerY){r.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2- (this.offsetHeight / 2)+ (blah = document.documentElement.scrollTop? document.documentElement.scrollTop: document.body.scrollTop)+ "px"');r.marginTop=0}else t.centerY||r.setExpression("top",'(document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"')})}if(r){r.data("blockUI.parent",r.parent());s.append(r);if(r.jquery||r.nodeType)e(r).show()}if((o||t.forceIframe)&&t.showOverlay)l.show();t.showOverlay&&c.show();r&&s.show();t.onBlock&&t.onBlock();i(1,t);f=r}function n(t){t=e.extend({},e.tn3block.defaults,t||{});i(0,t);var n=e("body").children().filter(".blockUI").add("body > .blockUI");r(n,t)}function r(e,t){e.each(function(){this.parentNode&&this.parentNode.removeChild(this)});f.data("blockUI.parent").append(f);f=null;typeof t.onUnblock=="function"&&t.onUnblock.call(t.con)}function i(t,n){if(t||f)!n.bindEvents||t&&!n.showOverlay||(t?e(document).bind("mousedown mouseup keydown keypress",n,s):e(document).unbind("mousedown mouseup keydown keypress",s))}function s(t){var n=t.data;if(e(t.target).parents("div."+n.blockMsgClass).length>0)return true;return e(t.target).parents().children().filter("div.blockUI").length==0}var o=/MSIE/.test(navigator.userAgent),u=/MSIE 6.0/.test(navigator.userAgent),a=e.isFunction(document.createElement("div").style.setExpression);e.tn3block=function(e){t(e)};e.tn3unblock=function(e){n(e)};var f=undefined;e.tn3block.defaults={message:"<h1>Please wait...</h1>",overlayCSS:{},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:2147483647,allowBodyStretch:true,bindEvents:true,showOverlay:true,applyPlatformOpacityRules:true,onBlock:null,onUnblock:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",cssID:"tn3"}})(jQuery);(function(e){(e.fn.tn3.External=function(t,n){if(t){this.context=n;this.reqs=t.length;for(var r=0;r<t.length;r++)this.plugs[t[r].origin]=new e.fn.tn3.External[t[r].origin](t[r],this)}}).prototype={context:null,reqs:0,plugs:{},getImages:function(e,t){this.plugs[e.origin].getImages(e,t)},setAlbumData:function(e,t){this.reqs--;this.context.setAlbumData.call(this.context,e,t)},setImageData:function(e,t,n){this.context.setImageData.call(this.context,e,t,n)},getAlbumData:function(e){return this.context.data[e]}}})(jQuery);(function(){function e(e,t,n){n=(n||0)-1;for(var r=e?e.length:0;++n<r;)if(e[n]===t)return n;return-1}function t(t,n){var r=typeof n;if(t=t.l,"boolean"==r||null==n)return t[n]?0:-1;"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:g+n;return t=(t=t[r])&&t[i],"object"==r?t&&-1<e(t,n)?0:-1:t?0:-1}function n(e){var t=this.l,n=typeof e;if("boolean"==n||null==e)t[e]=true;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?e:g+e,t=t[n]||(t[n]={});"object"==n?(t[r]||(t[r]=[])).push(e):t[r]=true}}function r(e){return e.charCodeAt(0)}function i(e,t){for(var n=e.m,r=t.m,i=-1,s=n.length;++i<s;){var o=n[i],u=r[i];if(o!==u){if(o>u||typeof o=="undefined")return 1;if(o<u||typeof u=="undefined")return-1}}return e.n-t.n}function s(e){var t=-1,r=e.length,i=e[0],s=e[r/2|0],o=e[r-1];if(i&&typeof i=="object"&&s&&typeof s=="object"&&o&&typeof o=="object")return false;for(i=a(),i["false"]=i["null"]=i["true"]=i.undefined=false,s=a(),s.k=e,s.l=i,s.push=n;++t<r;)s.push(e[t]);return s}function o(e){return"\\"+V[e]}function u(){return d.pop()||[]}function a(){return v.pop()||{k:null,l:null,m:null,"false":false,n:0,"null":false,number:null,object:null,push:null,string:null,"true":false,"undefined":false,o:null}}function f(e){e.length=0,d.length<b&&d.push(e)}function l(e){var t=e.l;t&&l(t),e.k=e.l=e.m=e.object=e.number=e.string=e.o=null,v.length<b&&v.push(e)}function c(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1;n=n-t||0;for(var i=Array(0>n?0:n);++r<n;)i[r]=e[t+r];return i}function h(n){function d(e,t,n){if(!e||!X[typeof e])return e;t=t&&typeof n=="undefined"?t:tt(t,n,3);for(var r=-1,i=X[typeof e]&&jn(e),s=i?i.length:0;++r<s&&(n=i[r],false!==t(e[n],n,e)););return e}function v(e,t,n){var r;if(!e||!X[typeof e])return e;t=t&&typeof n=="undefined"?t:tt(t,n,3);for(r in e)if(false===t(e[r],r,e))break;return e}function b(e,t,n){var r,i=e,s=i;if(!i)return s;for(var o=arguments,u=0,a=typeof n=="number"?2:o.length;++u<a;)if((i=o[u])&&X[typeof i])for(var f=-1,l=X[typeof i]&&jn(i),c=l?l.length:0;++f<c;)r=l[f],"undefined"==typeof s[r]&&(s[r]=i[r]);return s}function V(e,t,n){var r,i=e,s=i;if(!i)return s;var o=arguments,u=0,a=typeof n=="number"?2:o.length;if(3<a&&"function"==typeof o[a-2])var f=tt(o[--a-1],o[a--],2);else 2<a&&"function"==typeof o[a-1]&&(f=o[--a]);for(;++u<a;)if((i=o[u])&&X[typeof i])for(var l=-1,c=X[typeof i]&&jn(i),h=c?c.length:0;++l<h;)r=c[l],s[r]=f?f(s[r],i[r]):i[r];return s}function J(e){var t,n=[];if(!e||!X[typeof e])return n;for(t in e)yn.call(e,t)&&n.push(t);return n}function K(e){return e&&typeof e=="object"&&!Bn(e)&&yn.call(e,"__wrapped__")?e:new Q(e)}function Q(e,t){this.__chain__=!!t,this.__wrapped__=e}function G(e){function t(){if(r){var e=c(r);bn.apply(e,arguments)}if(this instanceof t){var s=et(n.prototype),e=n.apply(s,e||arguments);return Et(e)?e:s}return n.apply(i,e||arguments)}var n=e[0],r=e[2],i=e[4];return Hn(t,e),t}function Z(e,t,n,r,i){if(n){var s=n(e);if(typeof s!="undefined")return s}if(!Et(e))return e;var o=cn.call(e);if(!U[o])return e;var a=Dn[o];switch(o){case H:case B:return new a(+e);case F:case R:return new a(e);case q:return s=a(e.source,N.exec(e)),s.lastIndex=e.lastIndex,s}if(o=Bn(e),t){var l=!r;r||(r=u()),i||(i=u());for(var h=r.length;h--;)if(r[h]==e)return i[h];s=o?a(e.length):{}}else s=o?c(e):V({},e);return o&&(yn.call(e,"index")&&(s.index=e.index),yn.call(e,"input")&&(s.input=e.input)),t?(r.push(e),i.push(s),(o?At:d)(e,function(e,o){s[o]=Z(e,t,n,r,i)}),l&&(f(r),f(i)),s):s}function et(e){return Et(e)?Tn(e):{}}function tt(e,t,n){if(typeof e!="function")return Vt;if(typeof t=="undefined"||!("prototype"in e))return e;var r=e.__bindData__;if(typeof r=="undefined"&&(Pn.funcNames&&(r=!e.name),r=r||!Pn.funcDecomp,!r)){var i=mn.call(e);Pn.funcNames||(r=!C.test(i)),r||(r=O.test(i),Hn(e,r))}if(false===r||true!==r&&1&r[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return Wt(e,t)}function nt(e){function t(){var e=a?o:this;if(i){var d=c(i);bn.apply(d,arguments)}return(s||l)&&(d||(d=c(arguments)),s&&bn.apply(d,s),l&&d.length<u)?(r|=16,nt([n,h?r:-4&r,d,null,o,u])):(d||(d=arguments),f&&(n=e[p]),this instanceof t?(e=et(n.prototype),d=n.apply(e,d),Et(d)?d:e):n.apply(e,d))}var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=1&r,f=2&r,l=4&r,h=8&r,p=n;return Hn(t,e),t}function rt(n,r){var i=-1,o=ht(),u=n?n.length:0,a=u>=y&&o===e,f=[];if(a){var c=s(r);c?(o=t,r=c):a=false}for(;++i<u;)c=n[i],0>o(r,c)&&f.push(c);return a&&l(r),f}function it(e,t,n,r){r=(r||0)-1;for(var i=e?e.length:0,s=[];++r<i;){var o=e[r];if(o&&typeof o=="object"&&typeof o.length=="number"&&(Bn(o)||mt(o))){t||(o=it(o,t,n));var u=-1,a=o.length,f=s.length;for(s.length+=a;++u<a;)s[f++]=o[u]}else n||s.push(o)}return s}function st(e,t,n,r,i,s){if(n){var o=n(e,t);if(typeof o!="undefined")return!!o}if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&X[typeof e]||t&&X[typeof t]))return false;if(null==e||null==t)return e===t;var a=cn.call(e),l=cn.call(t);if(a==D&&(a=I),l==D&&(l=I),a!=l)return false;switch(a){case H:case B:return+e==+t;case F:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case q:case R:return e==on(t)}if(l=a==P,!l){var c=yn.call(e,"__wrapped__"),h=yn.call(t,"__wrapped__");if(c||h)return st(c?e.__wrapped__:e,h?t.__wrapped__:t,n,r,i,s);if(a!=I)return false;if(a=e.constructor,c=t.constructor,a!=c&&!(wt(a)&&a instanceof a&&wt(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return false}for(a=!i,i||(i=u()),s||(s=u()),c=i.length;c--;)if(i[c]==e)return s[c]==t;var p=0,o=true;if(i.push(e),s.push(t),l){if(c=e.length,p=t.length,(o=p==c)||r)for(;p--;)if(l=c,h=t[p],r)for(;l--&&!(o=st(e[l],h,n,r,i,s)););else if(!(o=st(e[p],h,n,r,i,s)))break}else v(t,function(t,u,a){return yn.call(a,u)?(p++,o=yn.call(e,u)&&st(e[u],t,n,r,i,s)):void 0}),o&&!r&&v(e,function(e,t,n){return yn.call(n,t)?o=-1<--p:void 0});return i.pop(),s.pop(),a&&(f(i),f(s)),o}function ot(e,t,n,r,i){(Bn(t)?At:d)(t,function(t,s){var o,u,a=t,f=e[s];if(t&&((u=Bn(t))||Un(t))){for(a=r.length;a--;)if(o=r[a]==t){f=i[a];break}if(!o){var l;n&&(a=n(f,t),l=typeof a!="undefined")&&(f=a),l||(f=u?Bn(f)?f:[]:Un(f)?f:{}),r.push(t),i.push(f),l||ot(f,t,n,r,i)}}else n&&(a=n(f,t),typeof a=="undefined"&&(a=t)),typeof a!="undefined"&&(f=a);e[s]=f})}function ut(e,t){return e+vn(_n()*(t-e+1))}function at(n,r,i){var o=-1,a=ht(),c=n?n.length:0,h=[],p=!r&&c>=y&&a===e,d=i||p?u():h;for(p&&(d=s(d),a=t);++o<c;){var v=n[o],m=i?i(v,o,n):v;(r?!o||d[d.length-1]!==m:0>a(d,m))&&((i||p)&&d.push(m),h.push(v))}return p?(f(d.k),l(d)):i&&f(d),h}function ft(e){return function(t,n,r){var i={};n=K.createCallback(n,r,3),r=-1;var s=t?t.length:0;if(typeof s=="number")for(;++r<s;){var o=t[r];e(i,o,n(o,r,t),t)}else d(t,function(t,r,s){e(i,t,n(t,r,s),s)});return i}}function lt(e,t,n,r,i,s){var o=1&t,u=4&t,a=16&t,f=32&t;if(!(2&t||wt(e)))throw new un;a&&!n.length&&(t&=-17,a=n=false),f&&!r.length&&(t&=-33,f=r=false);var l=e&&e.__bindData__;return l&&true!==l?(l=c(l),l[2]&&(l[2]=c(l[2])),l[3]&&(l[3]=c(l[3])),!o||1&l[1]||(l[4]=i),!o&&1&l[1]&&(t|=8),!u||4&l[1]||(l[5]=s),a&&bn.apply(l[2]||(l[2]=[]),n),f&&Sn.apply(l[3]||(l[3]=[]),r),l[1]|=t,lt.apply(null,l)):(1==t||17===t?G:nt)([e,t,n,r,i,s])}function ct(e){return Fn[e]}function ht(){var t=(t=K.indexOf)===Ft?e:t;return t}function pt(e){return typeof e=="function"&&hn.test(e)}function dt(e){var t,n;return e&&cn.call(e)==I&&(t=e.constructor,!wt(t)||t instanceof t)?(v(e,function(e,t){n=t}),typeof n=="undefined"||yn.call(e,n)):false}function vt(e){return In[e]}function mt(e){return e&&typeof e=="object"&&typeof e.length=="number"&&cn.call(e)==D||false}function gt(e,t,n){var r=jn(e),i=r.length;for(t=tt(t,n,3);i--&&(n=r[i],false!==t(e[n],n,e)););return e}function yt(e){var t=[];return v(e,function(e,n){wt(e)&&t.push(n)}),t.sort()}function bt(e){for(var t=-1,n=jn(e),r=n.length,i={};++t<r;){var s=n[t];i[e[s]]=s}return i}function wt(e){return typeof e=="function"}function Et(e){return!(!e||!X[typeof e])}function St(e){return typeof e=="number"||e&&typeof e=="object"&&cn.call(e)==F||false}function xt(e){return typeof e=="string"||e&&typeof e=="object"&&cn.call(e)==R||false}function Tt(e){for(var t=-1,n=jn(e),r=n.length,i=Gt(r);++t<r;)i[t]=e[n[t]];return i}function Nt(e,t,n){var r=-1,i=ht(),s=e?e.length:0,o=false;return n=(0>n?An(0,s+n):n)||0,Bn(e)?o=-1<i(e,t,n):typeof s=="number"?o=-1<(xt(e)?e.indexOf(t,n):i(e,t,n)):d(e,function(e){return++r<n?void 0:!(o=e===t)}),o}function Ct(e,t,n){var r=true;t=K.createCallback(t,n,3),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i&&(r=!!t(e[n],n,e)););else d(e,function(e,n,i){return r=!!t(e,n,i)});return r}function kt(e,t,n){var r=[];t=K.createCallback(t,n,3),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i;){var s=e[n];t(s,n,e)&&r.push(s)}else d(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function Lt(e,t,n){t=K.createCallback(t,n,3),n=-1;var r=e?e.length:0;if(typeof r!="number"){var i;return d(e,function(e,n,r){return t(e,n,r)?(i=e,false):void 0}),i}for(;++n<r;){var s=e[n];if(t(s,n,e))return s}}function At(e,t,n){var r=-1,i=e?e.length:0;if(t=t&&typeof n=="undefined"?t:tt(t,n,3),typeof i=="number")for(;++r<i&&false!==t(e[r],r,e););else d(e,t);return e}function Ot(e,t,n){var r=e?e.length:0;if(t=t&&typeof n=="undefined"?t:tt(t,n,3),typeof r=="number")for(;r--&&false!==t(e[r],r,e););else{var i=jn(e),r=i.length;d(e,function(e,n,s){return n=i?i[--r]:--r,t(s[n],n,s)})}return e}function Mt(e,t,n){var r=-1,i=e?e.length:0;if(t=K.createCallback(t,n,3),typeof i=="number")for(var s=Gt(i);++r<i;)s[r]=t(e[r],r,e);else s=[],d(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function _t(e,t,n){var i=-1/0,s=i;if(typeof t!="function"&&n&&n[t]===e&&(t=null),null==t&&Bn(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u>s&&(s=u)}}else t=null==t&&xt(e)?r:K.createCallback(t,n,3),At(e,function(e,n,r){n=t(e,n,r),n>i&&(i=n,s=e)});return s}function Dt(e,t,n,r){if(!e)return n;var i=3>arguments.length;t=K.createCallback(t,r,4);var s=-1,o=e.length;if(typeof o=="number")for(i&&(n=e[++s]);++s<o;)n=t(n,e[s],s,e);else d(e,function(e,r,s){n=i?(i=false,e):t(n,e,r,s)});return n}function Pt(e,t,n,r){var i=3>arguments.length;return t=K.createCallback(t,r,4),Ot(e,function(e,r,s){n=i?(i=false,e):t(n,e,r,s)}),n}function Ht(e){var t=-1,n=e?e.length:0,r=Gt(typeof n=="number"?n:0);return At(e,function(e){var n=ut(0,++t);r[t]=r[n],r[n]=e}),r}function Bt(e,t,n){var r;t=K.createCallback(t,n,3),n=-1;var i=e?e.length:0;if(typeof i=="number")for(;++n<i&&!(r=t(e[n],n,e)););else d(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function jt(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=-1;for(t=K.createCallback(t,n,3);++s<i&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[0]:p;return c(e,0,On(An(0,r),i))}function Ft(t,n,r){if(typeof r=="number"){var i=t?t.length:0;r=0>r?An(0,i+r):r||0}else if(r)return r=qt(t,n),t[r]===n?r:-1;return e(t,n,r)}function It(e,t,n){if(typeof t!="number"&&null!=t){var r=0,i=-1,s=e?e.length:0;for(t=K.createCallback(t,n,3);++i<s&&t(e[i],i,e);)r++}else r=null==t||n?1:An(0,t);return c(e,r)}function qt(e,t,n,r){var i=0,s=e?e.length:i;for(n=n?K.createCallback(n,r,1):Vt,t=n(t);i<s;)r=i+s>>>1,n(e[r])<t?i=r+1:s=r;return i}function Rt(e,t,n,r){return typeof t!="boolean"&&null!=t&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=false),null!=n&&(n=K.createCallback(n,r,3)),at(e,t,n)}function Ut(){for(var e=1<arguments.length?arguments:arguments[0],t=-1,n=e?_t(Vn(e,"length")):0,r=Gt(0>n?0:n);++t<n;)r[t]=Vn(e,t);return r}function zt(e,t){var n=-1,r=e?e.length:0,i={};for(t||!r||Bn(e[0])||(t=[]);++n<r;){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function Wt(e,t){return 2<arguments.length?lt(e,17,c(arguments,2),null,t):lt(e,1,null,null,t)}function Xt(e,t,n){function r(){l&&dn(l),o=l=c=p,(v||d!==t)&&(h=$n(),u=e.apply(f,s),l||o||(s=f=null))}function i(){var n=t-($n()-a);0<n?l=wn(i,n):(o&&dn(o),n=c,o=l=c=p,n&&(h=$n(),u=e.apply(f,s),l||o||(s=f=null)))}var s,o,u,a,f,l,c,h=0,d=false,v=true;if(!wt(e))throw new un;if(t=An(0,t)||0,true===n)var m=true,v=false;else Et(n)&&(m=n.leading,d="maxWait"in n&&(An(t,n.maxWait)||0),v="trailing"in n?n.trailing:v);return function(){if(s=arguments,a=$n(),f=this,c=v&&(l||!m),false===d)var n=m&&!l;else{o||m||(h=a);var p=d-(a-h),g=0>=p;g?(o&&(o=dn(o)),h=a,u=e.apply(f,s)):o||(o=wn(r,p))}return g&&l?l=dn(l):l||t===d||(l=wn(i,t)),n&&(g=true,u=e.apply(f,s)),!g||l||o||(s=f=null),u}}function Vt(e){return e}function $t(e,t,n){var r=true,i=t&&yt(t);t&&(n||i.length)||(null==n&&(n=t),s=Q,t=e,e=K,i=yt(t)),false===n?r=false:Et(n)&&"chain"in n&&(r=n.chain);var s=e,o=wt(s);At(i,function(n){var i=e[n]=t[n];o&&(s.prototype[n]=function(){var t=this.__chain__,n=this.__wrapped__,o=[n];if(bn.apply(o,arguments),o=i.apply(e,o),r||t){if(n===o&&Et(o))return this;o=new s(o),o.__chain__=t}return o})})}function Jt(){}function Kt(e){return function(t){return t[e]}}function Qt(){return this.__wrapped__}n=n?Y.defaults($.Object(),n,Y.pick($,_)):$;var Gt=n.Array,Yt=n.Boolean,Zt=n.Date,en=n.Function,tn=n.Math,nn=n.Number,rn=n.Object,sn=n.RegExp,on=n.String,un=n.TypeError,an=[],fn=rn.prototype,ln=n._,cn=fn.toString,hn=sn("^"+on(cn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),pn=tn.ceil,dn=n.clearTimeout,vn=tn.floor,mn=en.prototype.toString,gn=pt(gn=rn.getPrototypeOf)&&gn,yn=fn.hasOwnProperty,bn=an.push,wn=n.setTimeout,En=an.splice,Sn=an.unshift,xn=function(){try{var e={},t=pt(t=rn.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}(),Tn=pt(Tn=rn.create)&&Tn,Nn=pt(Nn=Gt.isArray)&&Nn,Cn=n.isFinite,kn=n.isNaN,Ln=pt(Ln=rn.keys)&&Ln,An=tn.max,On=tn.min,Mn=n.parseInt,_n=tn.random,Dn={};Dn[P]=Gt,Dn[H]=Yt,Dn[B]=Zt,Dn[j]=en,Dn[I]=rn,Dn[F]=nn,Dn[q]=sn,Dn[R]=on,Q.prototype=K.prototype;var Pn=K.support={};Pn.funcDecomp=!pt(n.a)&&O.test(h),Pn.funcNames=typeof en.name=="string",K.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:k,variable:"",imports:{_:K}},Tn||(et=function(){function e(){}return function(t){if(Et(t)){e.prototype=t;var r=new e;e.prototype=null}return r||n.Object()}}());var Hn=xn?function(e,t){W.value=t,xn(e,"__bindData__",W)}:Jt,Bn=Nn||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&cn.call(e)==P||false},jn=Ln?function(e){return Et(e)?Ln(e):[]}:J,Fn={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},In=bt(Fn),qn=sn("("+jn(In).join("|")+")","g"),Rn=sn("["+jn(Fn).join("")+"]","g"),Un=gn?function(e){if(!e||cn.call(e)!=I)return false;var t=e.valueOf,n=pt(t)&&(n=gn(t))&&gn(n);return n?e==n||gn(e)==n:dt(e)}:dt,zn=ft(function(e,t,n){yn.call(e,n)?e[n]++:e[n]=1}),Wn=ft(function(e,t,n){(yn.call(e,n)?e[n]:e[n]=[]).push(t)}),Xn=ft(function(e,t,n){e[n]=t}),Vn=Mt,$n=pt($n=Zt.now)&&$n||function(){return(new Zt).getTime()},Jn=8==Mn(w+"08")?Mn:function(e,t){return Mn(xt(e)?e.replace(L,""):e,t||0)};return K.after=function(e,t){if(!wt(t))throw new un;return function(){return 1>--e?t.apply(this,arguments):void 0}},K.assign=V,K.at=function(e){for(var t=arguments,n=-1,r=it(t,true,false,1),t=t[2]&&t[2][t[1]]===e?1:r.length,i=Gt(t);++n<t;)i[n]=e[r[n]];return i},K.bind=Wt,K.bindAll=function(e){for(var t=1<arguments.length?it(arguments,true,false,1):yt(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=lt(e[i],1,null,null,e)}return e},K.bindKey=function(e,t){return 2<arguments.length?lt(t,19,c(arguments,2),null,e):lt(t,3,null,null,e)},K.chain=function(e){return e=new Q(e),e.__chain__=true,e},K.compact=function(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r},K.compose=function(){for(var e=arguments,t=e.length;t--;)if(!wt(e[t]))throw new un;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},K.constant=function(e){return function(){return e}},K.countBy=zn,K.create=function(e,t){var n=et(e);return t?V(n,t):n},K.createCallback=function(e,t,n){var r=typeof e;if(null==e||"function"==r)return tt(e,t,n);if("object"!=r)return Kt(e);var i=jn(e),s=i[0],o=e[s];return 1!=i.length||o!==o||Et(o)?function(t){for(var n=i.length,r=false;n--&&(r=st(t[i[n]],e[i[n]],null,true)););return r}:function(e){return e=e[s],o===e&&(0!==o||1/o==1/e)}},K.curry=function(e,t){return t=typeof t=="number"?t:+t||e.length,lt(e,4,null,null,null,t)},K.debounce=Xt,K.defaults=b,K.defer=function(e){if(!wt(e))throw new un;var t=c(arguments,1);return wn(function(){e.apply(p,t)},1)},K.delay=function(e,t){if(!wt(e))throw new un;var n=c(arguments,2);return wn(function(){e.apply(p,n)},t)},K.difference=function(e){return rt(e,it(arguments,true,true,1))},K.filter=kt,K.flatten=function(e,t,n,r){return typeof t!="boolean"&&null!=t&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=false),null!=n&&(e=Mt(e,n,r)),it(e,t)},K.forEach=At,K.forEachRight=Ot,K.forIn=v,K.forInRight=function(e,t,n){var r=[];v(e,function(e,t){r.push(t,e)});var i=r.length;for(t=tt(t,n,3);i--&&false!==t(r[i--],r[i],e););return e},K.forOwn=d,K.forOwnRight=gt,K.functions=yt,K.groupBy=Wn,K.indexBy=Xn,K.initial=function(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=i;for(t=K.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else r=null==t||n?1:t||r;return c(e,0,On(An(0,i-r),i))},K.intersection=function(){for(var n=[],r=-1,i=arguments.length,o=u(),a=ht(),c=a===e,h=u();++r<i;){var p=arguments[r];(Bn(p)||mt(p))&&(n.push(p),o.push(c&&p.length>=y&&s(r?n[r]:h)))}var c=n[0],d=-1,v=c?c.length:0,m=[];e:for(;++d<v;){var g=o[0],p=c[d];if(0>(g?t(g,p):a(h,p))){for(r=i,(g||h).push(p);--r;)if(g=o[r],0>(g?t(g,p):a(n[r],p)))continue e;m.push(p)}}for(;i--;)(g=o[i])&&l(g);return f(o),f(h),m},K.invert=bt,K.invoke=function(e,t){var n=c(arguments,2),r=-1,i=typeof t=="function",s=e?e.length:0,o=Gt(typeof s=="number"?s:0);return At(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o},K.keys=jn,K.map=Mt,K.mapValues=function(e,t,n){var r={};return t=K.createCallback(t,n,3),d(e,function(e,n,i){r[n]=t(e,n,i)}),r},K.max=_t,K.memoize=function(e,t){function n(){var r=n.cache,i=t?t.apply(this,arguments):g+arguments[0];return yn.call(r,i)?r[i]:r[i]=e.apply(this,arguments)}if(!wt(e))throw new un;return n.cache={},n},K.merge=function(e){var t=arguments,n=2;if(!Et(e))return e;if("number"!=typeof t[2]&&(n=t.length),3<n&&"function"==typeof t[n-2])var r=tt(t[--n-1],t[n--],2);else 2<n&&"function"==typeof t[n-1]&&(r=t[--n]);for(var t=c(arguments,1,n),i=-1,s=u(),o=u();++i<n;)ot(e,t[i],r,s,o);return f(s),f(o),e},K.min=function(e,t,n){var i=1/0,s=i;if(typeof t!="function"&&n&&n[t]===e&&(t=null),null==t&&Bn(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u<s&&(s=u)}}else t=null==t&&xt(e)?r:K.createCallback(t,n,3),At(e,function(e,n,r){n=t(e,n,r),n<i&&(i=n,s=e)});return s},K.omit=function(e,t,n){var r={};if(typeof t!="function"){var i=[];v(e,function(e,t){i.push(t)});for(var i=rt(i,it(arguments,true,false,1)),s=-1,o=i.length;++s<o;){var u=i[s];r[u]=e[u]}}else t=K.createCallback(t,n,3),v(e,function(e,n,i){t(e,n,i)||(r[n]=e)});return r},K.once=function(e){var t,n;if(!wt(e))throw new un;return function(){return t?n:(t=true,n=e.apply(this,arguments),e=null,n)}},K.pairs=function(e){for(var t=-1,n=jn(e),r=n.length,i=Gt(r);++t<r;){var s=n[t];i[t]=[s,e[s]]}return i},K.partial=function(e){return lt(e,16,c(arguments,1))},K.partialRight=function(e){return lt(e,32,null,c(arguments,1))},K.pick=function(e,t,n){var r={};if(typeof t!="function")for(var i=-1,s=it(arguments,true,false,1),o=Et(e)?s.length:0;++i<o;){var u=s[i];u in e&&(r[u]=e[u])}else t=K.createCallback(t,n,3),v(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r},K.pluck=Vn,K.property=Kt,K.pull=function(e){for(var t=arguments,n=0,r=t.length,i=e?e.length:0;++n<r;)for(var s=-1,o=t[n];++s<i;)e[s]===o&&(En.call(e,s--,1),i--);return e},K.range=function(e,t,n){e=+e||0,n=typeof n=="number"?n:+n||1,null==t&&(t=e,e=0);var r=-1;t=An(0,pn((t-e)/(n||1)));for(var i=Gt(t);++r<t;)i[r]=e,e+=n;return i},K.reject=function(e,t,n){return t=K.createCallback(t,n,3),kt(e,function(e,n,r){return!t(e,n,r)})},K.remove=function(e,t,n){var r=-1,i=e?e.length:0,s=[];for(t=K.createCallback(t,n,3);++r<i;)n=e[r],t(n,r,e)&&(s.push(n),En.call(e,r--,1),i--);return s},K.rest=It,K.shuffle=Ht,K.sortBy=function(e,t,n){var r=-1,s=Bn(t),o=e?e.length:0,c=Gt(typeof o=="number"?o:0);for(s||(t=K.createCallback(t,n,3)),At(e,function(e,n,i){var o=c[++r]=a();s?o.m=Mt(t,function(t){return e[t]}):(o.m=u())[0]=t(e,n,i),o.n=r,o.o=e}),o=c.length,c.sort(i);o--;)e=c[o],c[o]=e.o,s||f(e.m),l(e);return c},K.tap=function(e,t){return t(e),e},K.throttle=function(e,t,n){var r=true,i=true;if(!wt(e))throw new un;return false===n?r=false:Et(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),z.leading=r,z.maxWait=t,z.trailing=i,Xt(e,t,z)},K.times=function(e,t,n){e=-1<(e=+e)?e:0;var r=-1,i=Gt(e);for(t=tt(t,n,1);++r<e;)i[r]=t(r);return i},K.toArray=function(e){return e&&typeof e.length=="number"?c(e):Tt(e)},K.transform=function(e,t,n,r){var i=Bn(e);if(null==n)if(i)n=[];else{var s=e&&e.constructor;n=et(s&&s.prototype)}return t&&(t=K.createCallback(t,r,4),(i?At:d)(e,function(e,r,i){return t(n,e,r,i)})),n},K.union=function(){return at(it(arguments,true,true))},K.uniq=Rt,K.values=Tt,K.where=kt,K.without=function(e){return rt(e,c(arguments,1))},K.wrap=function(e,t){return lt(t,16,[e])},K.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(Bn(n)||mt(n))var r=r?at(rt(r,n).concat(rt(n,r))):n}return r||[]},K.zip=Ut,K.zipObject=zt,K.collect=Mt,K.drop=It,K.each=At,K.eachRight=Ot,K.extend=V,K.methods=yt,K.object=zt,K.select=kt,K.tail=It,K.unique=Rt,K.unzip=Ut,$t(K),K.clone=function(e,t,n,r){return typeof t!="boolean"&&null!=t&&(r=n,n=t,t=false),Z(e,t,typeof n=="function"&&tt(n,r,1))},K.cloneDeep=function(e,t,n){return Z(e,true,typeof t=="function"&&tt(t,n,1))},K.contains=Nt,K.escape=function(e){return null==e?"":on(e).replace(Rn,ct)},K.every=Ct,K.find=Lt,K.findIndex=function(e,t,n){var r=-1,i=e?e.length:0;for(t=K.createCallback(t,n,3);++r<i;)if(t(e[r],r,e))return r;return-1},K.findKey=function(e,t,n){var r;return t=K.createCallback(t,n,3),d(e,function(e,n,i){return t(e,n,i)?(r=n,false):void 0}),r},K.findLast=function(e,t,n){var r;return t=K.createCallback(t,n,3),Ot(e,function(e,n,i){return t(e,n,i)?(r=e,false):void 0}),r},K.findLastIndex=function(e,t,n){var r=e?e.length:0;for(t=K.createCallback(t,n,3);r--;)if(t(e[r],r,e))return r;return-1},K.findLastKey=function(e,t,n){var r;return t=K.createCallback(t,n,3),gt(e,function(e,n,i){return t(e,n,i)?(r=n,false):void 0}),r},K.has=function(e,t){return e?yn.call(e,t):false},K.identity=Vt,K.indexOf=Ft,K.isArguments=mt,K.isArray=Bn,K.isBoolean=function(e){return true===e||false===e||e&&typeof e=="object"&&cn.call(e)==H||false},K.isDate=function(e){return e&&typeof e=="object"&&cn.call(e)==B||false},K.isElement=function(e){return e&&1===e.nodeType||false},K.isEmpty=function(e){var t=true;if(!e)return t;var n=cn.call(e),r=e.length;return n==P||n==R||n==D||n==I&&typeof r=="number"&&wt(e.splice)?!r:(d(e,function(){return t=false}),t)},K.isEqual=function(e,t,n,r){return st(e,t,typeof n=="function"&&tt(n,r,2))},K.isFinite=function(e){return Cn(e)&&!kn(parseFloat(e))},K.isFunction=wt,K.isNaN=function(e){return St(e)&&e!=+e},K.isNull=function(e){return null===e},K.isNumber=St,K.isObject=Et,K.isPlainObject=Un,K.isRegExp=function(e){return e&&typeof e=="object"&&cn.call(e)==q||false},K.isString=xt,K.isUndefined=function(e){return typeof e=="undefined"},K.lastIndexOf=function(e,t,n){var r=e?e.length:0;for(typeof n=="number"&&(r=(0>n?An(0,r+n):On(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},K.mixin=$t,K.noConflict=function(){return n._=ln,this},K.noop=Jt,K.now=$n,K.parseInt=Jn,K.random=function(e,t,n){var r=null==e,i=null==t;return null==n&&(typeof e=="boolean"&&i?(n=e,e=1):i||typeof t!="boolean"||(n=t,i=true)),r&&i&&(t=1),e=+e||0,i?(t=e,e=0):t=+t||0,n||e%1||t%1?(n=_n(),On(e+n*(t-e+parseFloat("1e-"+((n+"").length-1))),t)):ut(e,t)},K.reduce=Dt,K.reduceRight=Pt,K.result=function(e,t){if(e){var n=e[t];return wt(n)?e[t]():n}},K.runInContext=h,K.size=function(e){var t=e?e.length:0;return typeof t=="number"?t:jn(e).length},K.some=Bt,K.sortedIndex=qt,K.template=function(e,t,n){var r=K.templateSettings;e=on(e||""),n=b({},n,r);var i,s=b({},n.imports,r.imports),r=jn(s),s=Tt(s),u=0,a=n.interpolate||A,f="__p+='",a=sn((n.escape||A).source+"|"+a.source+"|"+(a===k?T:A).source+"|"+(n.evaluate||A).source+"|$","g");e.replace(a,function(t,n,r,s,a,l){return r||(r=s),f+=e.slice(u,l).replace(M,o),n&&(f+="'+__e("+n+")+'"),a&&(i=true,f+="';"+a+";\n__p+='"),r&&(f+="'+((__t=("+r+"))==null?'':__t)+'"),u=l+t.length,t}),f+="';",a=n=n.variable,a||(n="obj",f="with("+n+"){"+f+"}"),f=(i?f.replace(E,""):f).replace(S,"$1").replace(x,"$1;"),f="function("+n+"){"+(a?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+f+"return __p}";try{var l=en(r,"return "+f).apply(p,s)}catch(c){throw c.source=f,c}return t?l(t):(l.source=f,l)},K.unescape=function(e){return null==e?"":on(e).replace(qn,vt)},K.uniqueId=function(e){var t=++m;return on(null==e?"":e)+t},K.all=Ct,K.any=Bt,K.detect=Lt,K.findWhere=Lt,K.foldl=Dt,K.foldr=Pt,K.include=Nt,K.inject=Dt,$t(function(){var e={};return d(K,function(t,n){K.prototype[n]||(e[n]=t)}),e}(),false),K.first=jt,K.last=function(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=i;for(t=K.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[i-1]:p;return c(e,An(0,i-r))},K.sample=function(e,t,n){return e&&typeof e.length!="number"&&(e=Tt(e)),null==t||n?e?e[ut(0,e.length-1)]:p:(e=Ht(e),e.length=On(An(0,t),e.length),e)},K.take=jt,K.head=jt,d(K,function(e,t){var n="sample"!==t;K.prototype[t]||(K.prototype[t]=function(t,r){var i=this.__chain__,s=e(this.__wrapped__,t,r);return i||null!=t&&(!r||n&&typeof t=="function")?new Q(s,i):s})}),K.VERSION="2.4.1",K.prototype.chain=function(){return this.__chain__=true,this},K.prototype.toString=function(){return on(this.__wrapped__)},K.prototype.value=Qt,K.prototype.valueOf=Qt,At(["join","pop","shift"],function(e){var t=an[e];K.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new Q(n,e):n}}),At(["push","reverse","sort","unshift"],function(e){var t=an[e];K.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),At(["concat","slice","splice"],function(e){var t=an[e];K.prototype[e]=function(){return new Q(t.apply(this.__wrapped__,arguments),this.__chain__)}}),K}var p,d=[],v=[],m=0,g=+(new Date)+"",y=75,b=40,w=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",E=/\b__p\+='';/g,S=/\b(__p\+=)''\+/g,x=/(__e\(.*?\)|\b__t\))\+'';/g,T=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,N=/\w*$/,C=/^\s*function[ \n\r\t]+\w/,k=/<%=([\s\S]+?)%>/g,L=RegExp("^["+w+"]*0+(?=.$)"),A=/($^)/,O=/\bthis\b/,M=/['\n\r\t\u2028\u2029\\]/g,_="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),D="[object Arguments]",P="[object Array]",H="[object Boolean]",B="[object Date]",j="[object Function]",F="[object Number]",I="[object Object]",q="[object RegExp]",R="[object String]",U={};U[j]=false,U[D]=U[P]=U[H]=U[B]=U[F]=U[I]=U[q]=U[R]=true;var z={leading:false,maxWait:0,trailing:false},W={configurable:false,enumerable:false,value:null,writable:false},X={"boolean":false,"function":true,object:true,number:false,string:false,"undefined":false},V={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},$=X[typeof window]&&window||this,J=X[typeof exports]&&exports&&!exports.nodeType&&exports,K=X[typeof module]&&module&&!module.nodeType&&module,Q=K&&K.exports===J&&J,G=X[typeof global]&&global;!G||G.global!==G&&G.window!==G||($=G);var Y=h();typeof define=="function"&&typeof define.amd=="object"&&define.amd?($._=Y,define(function(){return Y})):J&&K?Q?(K.exports=Y)._=Y:J._=Y:$._=Y}).call(this)
